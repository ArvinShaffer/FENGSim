\chapter{金属切削模型报告}
\label{ch:fundamentals}


\section{张量运算}
The dyadic product:
\begin{align*}
  \mathbf a \otimes \mathbf b = \left(\begin{array}{ccc}
    \mathbf a_1\mathbf b_1 & \mathbf a_1\mathbf b_2& \mathbf a_1\mathbf b_3 \\
    \mathbf a_2\mathbf b_1 & \mathbf a_2\mathbf b_2& \mathbf a_2\mathbf b_3 \\
    \mathbf a_3\mathbf b_1 & \mathbf a_3\mathbf b_2& \mathbf a_3\mathbf b_3 
    \end{array}\right)
\end{align*}

\begin{align*}
  \mathbf A \otimes \mathbf B =& \left(\begin{array}{ccc}
    \mathbf A_{11} \mathbf B & \mathbf A_{12} \mathbf B & \mathbf A_{13} \mathbf B \\
    \mathbf A_{21} \mathbf B & \mathbf A_{22} \mathbf B & \mathbf A_{23} \mathbf B \\
    \mathbf A_{31} \mathbf B & \mathbf A_{32} \mathbf B & \mathbf A_{33} \mathbf B 
  \end{array}\right) 
\end{align*}

T


\section{守恒方程}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%  应力张量定义
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{应力张量定义（stress tensor）}\label{se:2.1.1}
更多细节见\cite{AsaroLubarda}第93页。首先介绍Cauchy四面体定义应力张量，如图\ref{fig:2-1-1}。
\begin{figure}[!htbp]
  \centering
  \includegraphics[height=5cm]{fig/2/2-1-1.png}
  \caption{Cauchy四面体}
  \label{fig:2-1-1}
\end{figure}
$\mathbf e_1$、$\mathbf e_2$和$\mathbf e_3$分别为
\begin{align*}
  \mathbf e_1=\left(\begin{array}{c}
    1\\
    0\\
    0
  \end{array}\right)\qquad
  \mathbf e_2=\left(\begin{array}{c}
    0\\
    1\\
    0
  \end{array}\right)\qquad
  \mathbf e_3=\left(\begin{array}{c}
    0\\
    0\\
    1
  \end{array}\right)\,.
\end{align*}
$a_1$、$a_2$和$a_3$分别是三角形$BOC$、$AOC$和$AOB$的面积，$\mathbf T_{\mathbf e_1^{-}}$、$\mathbf T_{\mathbf e_2^{-}}$和$\mathbf T_{\mathbf e_3^{-}}$分别是三角形$BOC$、$AOC$和$AOB$上的面力，$\mathbf n$是面$ABC$上的法向向量，$a_{\mathbf n}$是三角形$ABC$的面积，$\mathbf T_{\mathbf n}$是三角形$ABC$上的面力，$v$是四面体体积，$\mathbf b$是体力密度，$\epsilon_1$、$\epsilon_2$和$\epsilon_3$分别是$OA$、$OB$和$OC$的长度。

很容易算出$a_i$面积，
\begin{align*}
  a_1 = \frac{1}{2}\epsilon_2\epsilon_3\,, \qquad a_2 = \frac{1}{2}\epsilon_1\epsilon_3 \,,\qquad a_3 = \frac{1}{2}\epsilon_1\epsilon_2 \,.
\end{align*}
根据三角形$ABC$面积的空间向量公式得到
\begin{equation}\label{eq:2-1:0}
  \begin{split}
  a_{\mathbf n}\mathbf n =& \frac{1}{2}(\overrightarrow{BA})\times(\overrightarrow{CA})\\
  =& \frac{1}{2}(\overrightarrow{OB}-\overrightarrow{OA})\times(\overrightarrow{OC}-\overrightarrow{OA})\\
  =& \frac{1}{2}(\epsilon_2\mathbf e_2 - \epsilon_1\mathbf e_1)\times(\epsilon_3\mathbf e_3 - \epsilon_1\mathbf e_1)\\
  =& \frac{1}{2}(\epsilon_3\epsilon_1\mathbf e_2 + \epsilon_1\epsilon_2\mathbf e_3 + \epsilon_2\epsilon_3\mathbf e_1)\\
  =& a_2\mathbf e_2 + a_3\mathbf e_3 + a_1\mathbf e_1\,.
  \end{split}
\end{equation}
将\eqref{eq:2-1:0}两边乘以$\mathbf e_i$，$i=1,2,3$，得到
\begin{align}\label{eq:2-1:1}
  a_{\mathbf n}\mathbf n\cdot \mathbf e_i
  =& (a_2\mathbf e_2 + a_3\mathbf e_3 + a_1\mathbf e_1)\cdot \mathbf e_i = a_i\,.
\end{align}

根据图\ref{fig:2-1-1}中四面体上的力平衡得到
\begin{align}\label{eq:2-1:2}
  a_{\mathbf n}\mathbf T_{\mathbf n} + a_{1}\mathbf T_{\mathbf e_1^{-}} + a_{2}\mathbf T_{\mathbf e_2^{-}} + a_{3}\mathbf T_{\mathbf e_3^{-}} + v\mathbf b = 0\,. 
\end{align}
\eqref{eq:2-1:2}两边除以$a_{\mathbf n}$并代入\eqref{eq:2-1:1}得到
\begin{align*}
  \mathbf T_{\mathbf n} + \frac{a_{1}}{a_{\mathbf n}}\mathbf T_{\mathbf e_1^{-}} + \frac{a_{2}}{a_{\mathbf n}}\mathbf T_{\mathbf e_2^{-}} + \frac{a_{3}}{a_{\mathbf n}}\mathbf T_{\mathbf e_3^{-}} +\frac{v}{a_{\mathbf n}}\mathbf b =& 0\\
  \mathbf T_{\mathbf n} + \mathbf n\cdot \mathbf e_1\mathbf T_{\mathbf e_1^{-}} + \mathbf n\cdot \mathbf e_2\mathbf T_{\mathbf e_2^{-}} + \mathbf n\cdot \mathbf e_3\mathbf T_{\mathbf e_3^{-}} +\frac{v}{a_{\mathbf n}}\mathbf b =& 0\,.
\end{align*}
当四面体体积$v$趋于无穷小时得到
\begin{align*}
  \mathbf T_{\mathbf n}& + \mathbf n\cdot \mathbf e_1\mathbf T_{\mathbf e_1^{-}} + \mathbf n\cdot \mathbf e_2\mathbf T_{\mathbf e_2^{-}} + \mathbf n\cdot \mathbf e_3\mathbf T_{\mathbf e_3^{-}} = 0\,.
\end{align*}
\begin{align*}
  \mathbf T_{\mathbf n} &= -\mathbf n\cdot \mathbf e_1\mathbf T_{\mathbf e_1^{-}} - \mathbf n\cdot \mathbf e_2\mathbf T_{\mathbf e_2^{-}} - \mathbf n\cdot \mathbf e_3\mathbf T_{\mathbf e_3^{-}}\\
  &= \mathbf n\cdot \mathbf e_1\mathbf T_{\mathbf e_1} + \mathbf n\cdot \mathbf e_2\mathbf T_{\mathbf e_2} + \mathbf n\cdot \mathbf e_3\mathbf T_{\mathbf e_3}\\
  &=  n_1\mathbf T_{\mathbf e_1} + n_2\mathbf T_{\mathbf e_2} + n_3\mathbf T_{\mathbf e_3} \\
  &=\mathbf n \cdot \left(\begin{array}{ccc}
    \mathbf T_{\mathbf e_1,1} &     \mathbf T_{\mathbf e_1,2} &     \mathbf T_{\mathbf e_1,3} \\
    \mathbf T_{\mathbf e_2,1} &     \mathbf T_{\mathbf e_2,2} &     \mathbf T_{\mathbf e_2,3} \\
    \mathbf T_{\mathbf e_3,1} &     \mathbf T_{\mathbf e_3,2} &     \mathbf T_{\mathbf e_3,3} 
  \end{array}\right)\,.
\end{align*}
由此定义应力张量
\begin{align*}
  \mathbf \sigma = \left(\begin{array}{ccc}
    \mathbf T_{\mathbf e_1,1} &     \mathbf T_{\mathbf e_1,2} &     \mathbf T_{\mathbf e_1,3} \\
    \mathbf T_{\mathbf e_2,1} &     \mathbf T_{\mathbf e_2,2} &     \mathbf T_{\mathbf e_2,3} \\
    \mathbf T_{\mathbf e_3,1} &     \mathbf T_{\mathbf e_3,2} &     \mathbf T_{\mathbf e_3,3} 
  \end{array}\right) \,.
\end{align*}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%  principal stresses and stress invariants
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsubsection{Principal Stresses}
For every compact, self-adjoint operator $A$ on an infinite-dimensional Hilbert space $H$, there exists an orthonormal system of eigenvalues $(u_n)$ corresponding to nonzero eigenvalues $(\lambda_n)$ such that every element $x\in H$ has a unique representation in the form
\begin{align*}
  x=\sum_{n=1}^{\infty}\alpha_nu_n+v
\end{align*}
where $\alpha_n\in\mathcal C$ and $v\in\mathcal N(A)$.


Principal Stresses见\cite{AsaroLubarda}中96页，$\sigma$是二阶张量，既3乘3矩阵，$\mathbf n$是向量，因此可以定义特征值问题，如下：
\begin{align}
  \mathbf\sigma\cdot\mathbf n = \sigma\mathbf n\,.
\end{align}
principal stresses的出发点非常简单，类似空间向量的norm，对于不同坐标系，空间向量的分量是不一样的，但是norm是一样的。
\begin{align}\label{eq:2-1-1:1}
  \begin{split}
  |\mathbf \sigma -\lambda\mathbf I| =& \left|\begin{array}{ccc}
    \mathbf \sigma_{1,1}-\lambda &  \mathbf \sigma_{1,2}  &  \mathbf \sigma_{1,3}  \\
    \mathbf \sigma_{2,1} &  \mathbf \sigma_{2,2}-\lambda  &  \mathbf \sigma_{2,3}  \\
    \mathbf \sigma_{3,1} &  \mathbf \sigma_{3,2}  &  \mathbf \sigma_{3,3}-\lambda  
  \end{array}\right|\\
  =&-\lambda^3 + I_1\lambda^2 - I_2\lambda + I_3 = 0
  \end{split}
\end{align}
\begin{align*}
  I_1 = \mathbf \sigma_{1,1} + \mathbf \sigma_{2,2} + \mathbf \sigma_{3,3} = \mathrm{tr}(\mathbf\sigma)
\end{align*}
\begin{align*}
  \begin{split}
  I_2 =&   \left|\begin{array}{cc}
    \mathbf \sigma_{2,2} &  \mathbf \sigma_{2,3}    \\
    \mathbf \sigma_{3,2} &  \mathbf \sigma_{3,3}   
  \end{array}\right|
+  \left|\begin{array}{cc}
    \mathbf \sigma_{1,1} &  \mathbf \sigma_{1,3}    \\
    \mathbf \sigma_{3,1} &  \mathbf \sigma_{3,3}   
  \end{array}\right|
+  \left|\begin{array}{cc}
    \mathbf \sigma_{1,1} &  \mathbf \sigma_{1,2}    \\
    \mathbf \sigma_{2,1} &  \mathbf \sigma_{2,2}   
\end{array}\right|\\
=&\frac{1}{2}\left[(\mathrm{tr}(\mathbf\sigma))^2-\mathrm{tr}(\mathbf\sigma^2)\right]
  \end{split}
\end{align*}
\begin{align*}
  I_3 = \mathbf\sigma_{1,1}\mathbf \sigma_{2,2}\mathbf \sigma_{3,3} + 2\mathbf\sigma_{1,2}\mathbf \sigma_{2,3}\mathbf \sigma_{3,1} 
  -\mathbf\sigma_{1,2}^2\mathbf \sigma_{3,3}-\mathbf\sigma_{2,3}^2\mathbf \sigma_{1,1}-\mathbf\sigma_{3,1}^2\mathbf \sigma_{2,2}= \mathrm{det}(\mathbf\sigma)
\end{align*}

\textcolor{red}{$I_1,I_2,I_3$称为stress invariants，是不变的}，因此\eqref{eq:2-1-1:1}的解$\lambda$是不变的，根据$\lambda$定义principal stresses。
\begin{subequations}
\begin{align}\label{eq:2-1-1:2}
  \sigma_1 =&\mathrm{max}(\lambda_1,\lambda_2,\lambda_3)\\
  \sigma_2 =&\mathrm{min}(\lambda_1,\lambda_2,\lambda_3)\\
  \sigma_3 =&I_1-\sigma_1-\sigma_2
\end{align}
\end{subequations}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%  stress deviator tensor
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsubsection{Stress Deviator}
Stress deviator见\cite{AsaroLubarda}中102页。
\eqref{eq:2-1-1:3}中$\mathbf s$是stress deviator tensor.
\begin{align}\label{eq:2-1-1:3}
  \begin{split}
  &\left(\begin{array}{ccc}
    \mathbf \sigma_{11} &  \mathbf \sigma_{12}  &  \mathbf \sigma_{13}  \\
    \mathbf \sigma_{21} &  \mathbf \sigma_{22}  &  \mathbf \sigma_{23}  \\
    \mathbf \sigma_{31} &  \mathbf \sigma_{32}  &  \mathbf \sigma_{33}  
  \end{array}\right) =
  \left(\begin{array}{ccc}
    \mathbf s_{11} &  \mathbf s_{12}  &  \mathbf s_{13}  \\
    \mathbf s_{21} &  \mathbf s_{22}  &  \mathbf s_{23}  \\
    \mathbf s_{31} &  \mathbf s_{32}  &  \mathbf s_{33}  
  \end{array}\right) - \\
  &\hskip 3cm \left(\begin{array}{ccc}
    \frac{1}{3}\sum_{i=1}^3\mathbf \sigma_{ii} &  0  &  0  \\
   0  &  \frac{1}{3}\sum_{i=1}^3\mathbf \sigma_{ii}  &  0  \\
    0 &  0  &  \frac{1}{3}\sum_{i=1}^3\mathbf \sigma_{ii}
  \end{array}\right)
  \end{split}
\end{align}
对$\mathbf s$同样按照principal invariants方法处理.
\begin{align*}
  |\mathbf s -\lambda\mathbf I| 
  =-\lambda^3 + J_1\lambda^2 - J_2\lambda + J_3 = 0
\end{align*}
$J_i$是不变的, $J_1=0$表明$s$是纯剪切状态.
\begin{subequations}
\begin{align}\label{eq:2-1-1:4}
  J_1 =&0\\
  J_2 =&\frac{1}{3}I^2_1-I_2=\frac{1}{2}\left(\mathrm{tr}(\mathbf\sigma^2)-\frac{1}{3}\mathrm{tr}(\mathbf\sigma)^2\right)\\
  J_3 =&\frac{2}{27}I^3_1-\frac{1}{3}I_1I_2+I_3=\frac{1}{3}\left(\mathrm{tr}(\mathbf\sigma^3) - \mathrm{tr}(\mathbf\sigma^2)\mathrm{tr}(\mathbf\sigma)
  +\frac{2}{9}\mathrm{tr}(\mathbf\sigma)^3\right)
\end{align}
\end{subequations}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%  平衡方程
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{平衡方程（equation of equilibrium）}
更多细节见\cite{AsaroLubarda}第94页。根据静力平衡有
\begin{align}\label{eq:2-1:3}
  \int_S \mathbf T_{\mathbf n} \ud S + \int_{V}\mathbf b \ud V = 0\,. 
\end{align}
根据应力张量定义得到
\begin{align}\label{eq:2-1:4}
  \int_S \mathbf n\cdot \mathbf \sigma \ud S + \int_{V}\mathbf b \ud V = 0\,. 
\end{align}
根据Gauss定理得到
\begin{align}\label{eq:2-1:5}
  \int_V \nabla \cdot \mathbf \sigma \ud V + \int_{V}\mathbf b \ud V = 0\,.
\end{align}
因为\eqref{eq:2-1:5}对任意$V$成立，得到方程
\begin{align}\label{eq:2-1:6}
  -\nabla\cdot\mathbf \sigma = \mathbf b\,.
\end{align}

\subsection{连续方程（equation of continuity）}
更多细节见\cite{AsaroLubarda}第107页。根据质量守恒有
\begin{align}\label{eq:2-1:7}
  \frac{\ud }{\ud t}\int_V\rho\ud V = 0\,.
\end{align}
$\phi$是一个标量函数，有Transport Formulae输运公式见\cite{AsaroLubarda}第83页Lemma 4.4。
\begin{align}\label{eq:2-1:8}
  \frac{\ud }{\ud t}\int_V \phi \ud V = \int_{V}(\dot \phi + \phi \mathrm{tr} \mathbf L)\ud V\,.
\end{align}
$\mathbf L$定义见\cite{AsaroLubarda}第71页等式(4.121)。
\begin{align*}
  \mathbf L = \nabla \mathbf v = \left(\begin{array}{ccc}
    \frac{\partial v_1}{\partial x_1} &     \frac{\partial v_1}{\partial x_2} &     \frac{\partial v_1}{\partial x_3} \\
    \frac{\partial v_2}{\partial x_1} &     \frac{\partial v_2}{\partial x_2} &     \frac{\partial v_2}{\partial x_3} \\
    \frac{\partial v_3}{\partial x_1} &     \frac{\partial v_3}{\partial x_2} &     \frac{\partial v_3}{\partial x_3} 
    \end{array}\right)
\end{align*}
根据\eqref{eq:2-1:7}和\eqref{eq:2-1:8}得到
\begin{align}\label{eq:2-1:9}
  \frac{\ud }{\ud t}\int_V\rho\ud V = \int_V(\dot\rho + \rho \nabla\cdot\mathbf v)\ud V = 0\,.
\end{align}
因为\eqref{eq:2-1:9}对任意$V$成立，得到方程
\begin{align}\label{eq:2-1:10}
  \dot\rho + \rho \nabla\cdot\mathbf v = 0\,.
\end{align}

\subsection{运动方程（equation of motion）}
更多细节见\cite{AsaroLubarda}第108页。$\rho\phi$是一个标量函数，根据\eqref{eq:2-1:8}输运公式有
\begin{equation}\label{eq:2-1:11}
  \begin{split}
  \frac{\ud }{\ud t}\int_V \rho\phi \ud V =& \int_{V}(\dot{\rho\phi} + \rho\phi \mathrm{tr} \mathbf L) \ud V \\
  =& \int_{V}(\dot{\rho}\phi + \rho\dot{\phi} + \rho\phi \nabla\cdot\mathbf v) \ud V \\
  =& \int_{V}(\rho\dot{\phi} + (\dot{\rho} + \rho\nabla\cdot\mathbf v)\phi) \ud V\,.
  \end{split}
\end{equation}
在质量守恒的条件下，根据\eqref{eq:2-1:10}得到
\begin{equation}\label{eq:2-1:12}
  \begin{split}
  \frac{\ud }{\ud t}\int_V \rho\phi \ud V 
  =& \int_{V}\rho\dot{\phi}  \ud V
  \end{split}\,.
\end{equation}
根据牛顿第二定律有
\begin{align}\label{eq:2-1:13}
  \frac{\ud }{\ud t }\int_{V}\rho\mathbf v\ud V = \int_V\rho\hat{\mathbf b} \ud V + \int_S\mathbf T_{\mathbf n}\ud S\,.
\end{align}
$\hat{\mathbf b}$是单位质量受到的体力，\eqref{eq:2-1:6}中$\mathbf b$是单位体积受到的体力。
根据\eqref{eq:2-1:12}、应力张量定义和Gauss散度定理得到
\begin{equation}\label{eq:2-1:14}
  \begin{split}
    &\int_V\rho\dot{\mathbf v}\ud V = \int_V\rho\hat{\mathbf b} \ud V + \int_V\nabla\cdot\mathbf \sigma\ud V\\
    &\int_V(\rho\dot{\mathbf v}-\rho\hat{\mathbf b} -\nabla\cdot\mathbf \sigma)\ud V = 0\,.
  \end{split}
\end{equation}
因为\eqref{eq:2-1:14}对任意$V$成立，得到方程
\begin{align}\label{eq:2-1:15}
  \rho\dot{\mathbf v} -\nabla\cdot\mathbf \sigma = \rho\hat{\mathbf b}\,.
\end{align}

\subsection{能量方程（equation of energy）}
\subsubsection{热力学第一定律（First Law of Thermodynamics）}
更多细节见\cite{AsaroLubarda}第113页，注意这里用了符号简化。面力和体力功率为
\begin{align*}
  \mathcal P = \int_S \mathbf T_{\mathbf n}\cdot\mathbf v\ud S + \int_V \rho\hat{\mathbf b}\cdot\mathbf v\ud V\,.
\end{align*}
根据应力张量定义得到
\begin{align*}
  \mathcal P = &\int_S \mathbf n\cdot\mathbf \sigma\cdot\mathbf v\ud S + \int_V \rho\hat{\mathbf b}\cdot\mathbf v\ud V \\
  = &\int_S \mathbf n\cdot(\mathbf \sigma\cdot\mathbf v)\ud S + \int_V \rho\hat{\mathbf b}\cdot\mathbf v\ud V \,.
\end{align*}
根据Gauss散度定理得到
\begin{align*}
  \mathcal P = &\int_V \nabla\cdot(\mathbf \sigma\cdot\mathbf v)\ud V + \int_V \rho\hat{\mathbf b}\cdot\mathbf v\ud V \,.
\end{align*}
\begin{align*}
 \mathcal P = \int_V &\left(\frac{\partial\sigma_{11}}{\partial x_1}v_1 + \sigma_{11}\frac{\partial v_1}{\partial x_1}
  + \frac{\partial\sigma_{12}}{\partial x_1}v_2 + \sigma_{12}\frac{\partial v_2}{\partial x_1}
  + \frac{\partial\sigma_{13}}{\partial x_1}v_3 + \sigma_{13}\frac{\partial v_3}{\partial x_1}\right.\\
  & + \frac{\partial\sigma_{21}}{\partial x_2}v_1 + \sigma_{21}\frac{\partial v_1}{\partial x_2}
  + \frac{\partial\sigma_{22}}{\partial x_2}v_2 + \sigma_{22}\frac{\partial v_2}{\partial x_2}
  + \frac{\partial\sigma_{23}}{\partial x_2}v_3 + \sigma_{23}\frac{\partial v_3}{\partial x_2}\\
  & + \frac{\partial\sigma_{31}}{\partial x_3}v_1 + \sigma_{31}\frac{\partial v_1}{\partial x_3}
  + \frac{\partial\sigma_{32}}{\partial x_3}v_2 + \sigma_{32}\frac{\partial v_2}{\partial x_3}
  + \frac{\partial\sigma_{33}}{\partial x_3}v_3 + \sigma_{33}\frac{\partial v_3}{\partial x_3}\\
  & + \left.\rho\hat{b}_1v_1 + \rho\hat{b}_2v_2 + \rho\hat{b}_3v_3\right)\ud V \\
  = \int_V &\left(\nabla\cdot\mathbf\sigma+\rho\mathbf b\right)\cdot\mathbf v\ud V + \int_V \mathbf \sigma:\mathbf D\ud V
\end{align*}
\begin{align*}
  \mathbf D = \frac{1}{2}(\mathbf L + \mathbf L^T) =\frac{1}{2}\left(\begin{array}{ccc}
    2\frac{\partial v_1}{\partial x_1} &     \frac{\partial v_1}{\partial x_2} + \frac{\partial v_2}{\partial x_1}&     \frac{\partial v_1}{\partial x_3} + \frac{\partial v_3}{\partial x_1} \\
    \frac{\partial v_2}{\partial x_1} + \frac{\partial v_1}{\partial x_2} &     2\frac{\partial v_2}{\partial x_2} &     \frac{\partial v_2}{\partial x_3} +\frac{\partial v_3}{\partial x_2} \\
    \frac{\partial v_3}{\partial x_1} + \frac{\partial v_1}{\partial x_3} &     \frac{\partial v_3}{\partial x_2} + \frac{\partial v_2}{\partial x_3} &     2\frac{\partial v_3}{\partial x_3} 
    \end{array}\right)
\end{align*}
根据\eqref{eq:2-1:15}得到
\begin{align}\label{eq:2-1:16}
 \mathcal P = \int_V \rho\dot{\mathbf v}\cdot\mathbf v\ud V + \int_V \mathbf \sigma:\mathbf D\ud V\,.
\end{align}

热流$\mathbf q$和热源$r$产生的热量输入功率为
\begin{equation}\label{eq:2-1:17}
  \begin{split}
    \mathcal Q =& -\int_S\mathbf q\cdot\mathbf n\ud S + \int_V\rho r\ud V \\
    =& -\int_V\nabla\cdot\mathbf q\ud V + \int_V\rho r\ud V\,.
  \end{split}
\end{equation}

系统总能量包括动能和内能
\begin{align}\label{eq:2-1:18}
  \mathcal E = \int_V\frac{1}{2}\rho \mathbf v\cdot\mathbf v\ud V + \int_V\rho u\ud V\,.
\end{align}
\begin{align}\label{eq:2-1:19}
  \dot{\mathcal E} =& \mathcal P + \mathcal Q
\end{align}
将\eqref{eq:2-1:16}、\eqref{eq:2-1:17}和\eqref{eq:2-1:18}代入\eqref{eq:2-1:19}得到
\begin{equation}\label{eq:2-1:20}
  \begin{split}
  &\int_V\rho \mathbf v\cdot\dot{\mathbf v}\ud V + \int_V\rho \dot u\ud V =  \int_V \rho\dot{\mathbf v}\cdot\mathbf v\ud V + \int_V \mathbf \sigma:\mathbf D\ud V
  -\int_V\nabla\cdot\mathbf q\ud V + \int_V\rho r\ud V\\
  &\int_V(\rho \dot u-\mathbf \sigma:\mathbf D +\nabla\cdot\mathbf q-\rho r)\ud V =0\,.
  \end{split}
\end{equation}
因为\eqref{eq:2-1:20}对任意$V$成立，得到方程
\begin{align}\label{eq:2-1:21}
  \rho \dot u-\mathbf \sigma:\mathbf D +\nabla\cdot\mathbf q-\rho r=0\,.
\end{align}


\subsubsection{热力学第二定律（Second Law of Thermodynamics）}
能量守恒方程是热力学第一定律，建立了热和力之间的关系，热力学第二定律引入熵（entropy）将\eqref{eq:2-1:21}中的内能和应力替换掉，entropy的物理意义是体系混乱程度的度量。
熵的变化因素有两个，一个是系统和环境之间热量的交换，一个是由于变形引起的不可逆转的微观结构变化。

系统和环境之间热量交换引起的熵变化率为
\begin{align*}
  \begin{split}
    -\int_{S}\frac{\mathbf n \cdot \mathbf q}{T}\ud S + \int_{V}\rho\frac{r}{T}\ud V =& -\int_{V}\nabla\cdot \frac{\mathbf q}{T}\ud V + \int_{V}\rho\frac{r}{T}\ud V \\
    =& \int_{V}\left(-\frac{1}{\rho}\nabla\cdot \frac{\mathbf q}{T} + \frac{r}{T}\right)\rho\ud V\,.
  \end{split}
\end{align*}
由不可逆转的微观结构变化引起的熵变化率为$\gamma$，全部的熵变化率为
\begin{align*}
  \begin{split}
    \int_V\rho\frac{\ud s}{\ud t}\ud V = \int_{V}\left(-\frac{1}{\rho}\nabla\cdot \frac{\mathbf q}{T} + \frac{r}{T} + \gamma \right)\rho\ud V\,.
  \end{split}
\end{align*}
\begin{align}\label{eq:2.1.5.2:1}
  \begin{split}
  \frac{\ud s}{\ud t} + \frac{1}{\rho}\nabla\cdot \frac{\mathbf q}{T} - \frac{r}{T} - \gamma = 0
  \end{split}
\end{align}
\begin{align*}
  \frac{\ud s}{\ud t} + \frac{1}{\rho}\left((\nabla\cdot \mathbf q) \frac{1}{T} + \mathbf q \cdot\nabla\frac{1}{T}\right) - \frac{r}{T} - \gamma =& 0 \\
  \frac{\ud s}{\ud t} + \frac{1}{\rho}\left((\nabla\cdot \mathbf q) \frac{1}{T} - \frac{1}{T^2} \mathbf q \cdot \nabla T \right) - \frac{r}{T} - \gamma =& 0
\end{align*}

Helmholtz free energy定义为
\begin{align}
  \phi =  u - Ts\,.
\end{align}
因此
\begin{align}\label{eq:2.1.5.2:3}
  \frac{\partial\phi}{\partial T} =   - s\,.
\end{align}

\subsubsection{方程一}
重要假设：
\begin{itemize}
\item 假设\eqref{eq:2.1.5.2:1}中$T$是常数，换为$T_0$；
\item 假设没有不可逆转的微观结构变化引起的熵变；
\end{itemize}
\eqref{eq:2.1.5.2:1}简化为
\begin{align}\label{eq:2.1.5.2:2}
  \begin{split}
  T_0\frac{\ud s}{\ud t} + \frac{1}{\rho}\nabla\cdot \mathbf q - r  = 0
  \end{split}
\end{align}
比较\eqref{eq:2.1.5.2:2}和\eqref{eq:2-1:21}可以得到
\begin{align*}
  \begin{split}
  T_0\frac{\ud s}{\ud t}  = \dot u- \frac{1}{\rho}\mathbf \sigma:\mathbf D\,.
  \end{split}
\end{align*}
因此\eqref{eq:2.1.5.2:2}和\eqref{eq:2-1:21}是等同的。

entropy是一个应变和温度的函数$s(\mathbf E,T)$，因此
\begin{align*}
  \begin{split}
  T_0\left(\frac{\ud s}{\ud \mathbf E}:\frac{\ud \mathbf E}{\ud t} + \frac{\ud s}{\ud T}\frac{\ud T}{\ud t}\right) + \frac{1}{\rho}\nabla\cdot \mathbf q - r  = 0
  \end{split}
\end{align*}
定义latent heat为
\begin{align}\label{eq:2.1.5.3:2}
  \mathbf l = T_0\frac{\ud s}{\ud \mathbf E} \,.
\end{align}
定义specific heat为
\begin{align}\label{eq:2.1.5.3:3}
c_E = T_0\frac{\ud s}{\ud T}\,.
\end{align}
最后方程为
\begin{align}\label{eq:2.1.5.3:4}
  \begin{split}
  \mathbf l: \frac{\ud \mathbf E}{\ud t} + c_E\frac{\ud T}{\ud t} + \frac{1}{\rho}\nabla\cdot \left(\mathbf K \nabla T\right) - r  = 0
  \end{split}
\end{align}

\cite{AsaroLubarda}第131页公式(6.137)定义线性热弹性Holtzmann自由能为
\begin{align}\label{eq:2.1.5.3:5}
  \begin{split}
    \phi(e_{ij},T) =& \frac{1}{2}\lambda_Te_{kk}^2 + \mu e_{ij} e_{ij} - k_T\alpha_0(T - T_0)e_{kk} \\
    &- \frac{c_V^0}{2T_0}(T-T_0)^2 - s_0(T-T_0) + f_0\,.
  \end{split}
\end{align}
根据\eqref{eq:2.1.5.2:3}得到
\begin{align}\label{eq:2.1.5.3:6}
  \begin{split}
    s =& -\frac{\partial \phi}{\partial T} 
    =k_T\alpha_0e_{kk} + \frac{c_V^0}{T_0}(T-T_0) + s_0\,.
  \end{split}
\end{align}
根据\eqref{eq:2.1.5.3:2}和\eqref{eq:2.1.5.3:3}得到
\begin{align}\label{eq:2.1.5.3:7}
  \begin{split}
    \mathbf l =& T_0\frac{\ud s}{\ud \mathbf E} 
    = T_0k_T\alpha_0\delta_{ij}\\
    =&T_0\left(\lambda + \frac{2}{3}\mu\right)\alpha_0\delta_{ij}\\
    =&T_0\left(\frac{Ev}{(1+v)(1-2v)} + \frac{2}{3}\frac{E}{2(1+v)}\right)\alpha_0\delta_{ij}\\
    =&T_0\frac{E}{(1-2v)}\alpha_0\delta_{ij}\,,
  \end{split}
\end{align}
\begin{align}\label{eq:2.1.5.3:8}
  \begin{split}
    c_E = T_0\frac{\ud s}{\ud T}
    =T_0\frac{c^0_T}{T_0}\,.
  \end{split}
\end{align}
方程\eqref{eq:2.1.5.3:4}转为
\begin{align}\label{eq:2.1.5.3:9}
  \begin{split}
  T_0\frac{E}{(1-2v)}\alpha_0\frac{\ud \mathbf \varepsilon}{\ud t} + c_E\frac{\ud T}{\ud t} + \frac{1}{\rho}\nabla\cdot \left(\mathbf K \nabla T\right) - r  = 0
  \end{split}
\end{align}



\subsubsection{方程二}

方程二对热弹塑性很重要，因为形变会将机械能转变成热能。

热力学第一定律为
\begin{align*}\label{}
  \rho \dot u-\mathbf \sigma:\mathbf D +\nabla\cdot\mathbf q-\rho r=0\,.
\end{align*}

热力学第二定律为
\begin{align*}
  &\frac{\ud s}{\ud t} + \frac{1}{\rho}\left((\nabla\cdot \mathbf q) \frac{1}{T} - \frac{1}{T^2} \mathbf q \cdot \nabla T \right) - \frac{r}{T} - \gamma = 0\,,\\
  &\rho T\frac{\ud s}{\ud t} + \nabla\cdot \mathbf q - \frac{\rho}{T} \mathbf q \cdot \nabla T  - r\rho - \gamma T\rho = 0\,.
\end{align*}

温度方程实际就是从热力学第二定律获取的，但是将热力学第一定律和第二定律耦合，可以定义不可逆转的微观变化引起的熵变$\gamma$，这个是热塑性的关键。
\begin{align*}
  \left\{\begin{array}{l}
  \rho \dot u-\mathbf \sigma:\mathbf D +\nabla\cdot\mathbf q-\rho r=0\\
  \rho T\frac{\ud s}{\ud t} + \nabla\cdot \mathbf q - \frac{\rho}{T} \mathbf q \cdot \nabla T  - r\rho - \gamma T\rho = 0
  \end{array}
  \right.
\end{align*}

\begin{align}
\rho T\frac{\ud s}{\ud t}  -\rho \dot u + \mathbf \sigma:\mathbf D   - \frac{\rho}{T} \mathbf q \cdot \nabla T - \gamma T\rho =0
\end{align}

\begin{align*}
\rho T\frac{\ud s}{\ud t}  + \nabla\cdot\mathbf q-\rho r   - \frac{\rho}{T} \mathbf q \cdot \nabla T - \gamma T\rho =0
\end{align*}

定义Helmholtz自由能$\psi$
\begin{align*}
  \psi = u(\mathbf A, s) - s \theta
\end{align*}
\begin{align*}
  \frac{\partial \psi}{\partial \theta} = -s
\end{align*}


\begin{align*}
  &\rho T\frac{\ud s}{\ud t}  + \nabla\cdot\mathbf q-\rho r   - \frac{\rho}{T} \mathbf q \cdot \nabla T - \gamma T\rho =0\\
  &\rho T\left( \frac{\partial s}{\partial \theta}\dot\theta + \frac{\partial s}{\partial \mathbf A}:\dot{\mathbf A} \right)  + \nabla\cdot\mathbf q-\rho r   - \frac{\rho}{T} \mathbf q \cdot \nabla T - \gamma T\rho =0\\
  &-\rho T\left( \frac{\partial^2 \psi}{\partial \theta^2}\dot\theta + \frac{\partial^2 \psi}{\partial \mathbf A\partial \theta}:\dot{\mathbf A} \right)  + \nabla\cdot\mathbf q-\rho r   \uline{- \frac{\rho}{T} \mathbf q \cdot \nabla T - \gamma T\rho} =0
\end{align*}



\newpage
\section{应变和位移}
连续介质从参照状态到当前状态发生变形的应变和位移如图\ref{fig:2-2:1}。
\begin{figure}[!htbp]
  \centering
  \includegraphics[height=5cm]{fig/2/2.2/2-2-1.png}
  \caption{变形的应变和位移}
  \label{fig:2-2:1}
\end{figure}\\
从参照状态到当前状态有一个映射
\begin{align*}
  \mathbf x = \mathbf x(\mathbf X)\,.
\end{align*}
定义$\mathbf P_0=\mathbf X$，$\mathbf Q_0=\mathbf X +\ud\mathbf X$，$\mathbf P_1=\mathbf x$和$\mathbf Q_1=\mathbf x +\ud\mathbf x$有
\begin{align*}
  \mathbf Q_1-\mathbf P_1 =&\mathbf x(\mathbf Q_0) - \mathbf x(\mathbf P_0)\\
  =&\mathbf x(\mathbf P_0 + \mathbf Q_0 - \mathbf P_0) - \mathbf x(\mathbf P_0)\\
  \approx&\mathbf x(\mathbf P_0) + \nabla_{\mathbf X}\mathbf x(\mathbf P_0)(\mathbf Q_0 - \mathbf P_0) - \mathbf x(\mathbf P_0)  \\
   = &\nabla_{\mathbf X}\mathbf x(\mathbf P_0)\cdot(\mathbf Q_0-\mathbf P_0)\,.
\end{align*}
\begin{equation}\label{eq:2-2:1}
  \ud\mathbf x= \nabla_{\mathbf X}\mathbf x(\mathbf X)\cdot\ud\mathbf X=\mathbf F(\mathbf X)\cdot\ud\mathbf X=\left(\begin{array}{ccc}
    \frac{\partial x_1}{\partial X_1} & \frac{\partial x_1}{\partial X_2} & \frac{\partial x_1}{\partial X_3}\\
    \frac{\partial x_2}{\partial X_1} & \frac{\partial x_2}{\partial X_2} & \frac{\partial x_2}{\partial X_3}\\
    \frac{\partial x_3}{\partial X_1} & \frac{\partial x_3}{\partial X_2} & \frac{\partial x_3}{\partial X_3}
  \end{array}\right)\cdot\ud\mathbf X
\end{equation}

定义位移$\mathbf u=\mathbf x-\mathbf X$，两边对$\mathbf X$求导数得到
\begin{equation*}
  \begin{split}
  \left(\begin{array}{ccc}
    \frac{\partial u_1}{\partial X_1} & \frac{\partial u_1}{\partial X_2} & \frac{\partial u_1}{\partial X_3}\\
    \frac{\partial u_2}{\partial X_1} & \frac{\partial u_2}{\partial X_2} & \frac{\partial u_2}{\partial X_3}\\
    \frac{\partial u_3}{\partial X_1} & \frac{\partial u_3}{\partial X_2} & \frac{\partial u_3}{\partial X_3}
  \end{array}\right)
  =&
    \left(\begin{array}{ccc}
    \frac{\partial x_1}{\partial X_1} & \frac{\partial x_1}{\partial X_2} & \frac{\partial x_1}{\partial X_3}\\
    \frac{\partial x_2}{\partial X_1} & \frac{\partial x_2}{\partial X_2} & \frac{\partial x_2}{\partial X_3}\\
    \frac{\partial x_3}{\partial X_1} & \frac{\partial x_3}{\partial X_2} & \frac{\partial x_3}{\partial X_3}
  \end{array}\right)-\left(\begin{array}{ccc}
      1 & 0 & 0\\
      0 & 1 & 0\\
      0 & 0 & 1
    \end{array}\right)
  \end{split}
\end{equation*}
\begin{equation}\label{eq:2-2:2}
  \frac{\partial \mathbf u}{\partial \mathbf X} = \mathbf F - \mathbf I\,.
\end{equation}

\subsection{拉伸和正应变}
应变比较小时有$\|\ud \mathbf x\|\approx\|\ud \mathbf X\|$。
\begin{align*}
  \frac{\|\ud \mathbf x\|^2-\|\ud \mathbf X\|^2}{\|\ud \mathbf X\|^2} = \frac{(\|\ud \mathbf x\|-\|\ud \mathbf X\|)(\|\ud \mathbf x\|+\|\ud \mathbf X\|)}{\|\ud \mathbf X\|^2} \approx\frac{2(\|\ud \mathbf x\|-\|\ud \mathbf X\|)}{\|\ud \mathbf X\|}\,.
\end{align*}
\begin{align*}
  \frac{\|\ud \mathbf x\|-\|\ud \mathbf X\|}{\|\ud \mathbf X\|}\approx&\frac{1}{2}\frac{\|\ud \mathbf x\|^2-\|\ud \mathbf X\|^2}{\|\ud \mathbf X\|^2}\\
  = &  \frac{1}{2}\frac{\ud\mathbf x\cdot\ud\mathbf x-\ud \mathbf X\cdot\ud \mathbf X}{\|\ud \mathbf X\|^2}\\
  = &\frac{1}{2}\frac{(\mathbf F\cdot\ud\mathbf X)^T\cdot(\mathbf F\cdot\ud\mathbf X)-\ud \mathbf X\cdot\mathbf I\cdot\ud \mathbf X}{\|\ud \mathbf X\|^2}\\
  = &\frac{1}{2}\frac{\ud\mathbf X\cdot\mathbf F^T\cdot\mathbf F\cdot\ud\mathbf X-\ud \mathbf X\cdot\mathbf I\cdot\ud \mathbf X}{\|\ud \mathbf X\|^2}\\
  = &\frac{\ud\mathbf X}{\|\ud \mathbf X\|}\cdot\frac{\mathbf F^T\cdot\mathbf F-\mathbf I}{2}\cdot\frac{\ud\mathbf X}{\|\ud \mathbf X\|}
\end{align*}
定义应变张量为
\begin{align*}
  \mathbf E(\mathbf X)=\frac{\mathbf F^T\cdot\mathbf F-\mathbf I}{2}=\left(
  \begin{array}{ccc}
    E_{11} & E_{12} & E_{13} \\
    E_{21} & E_{22} & E_{23} \\
    E_{31} & E_{32} & E_{33} 
  \end{array}\right)\,.
\end{align*}
对于$\mathbf e_1=(1,0,0)$方向上的正应变有
\begin{align*}
  \frac{\ud\mathbf X}{\|\ud \mathbf X\|}\cdot\frac{\mathbf F^T\cdot\mathbf F-\mathbf I}{2}\cdot\frac{\ud\mathbf X}{\|\ud \mathbf X\|}=
  \mathbf e_1\cdot\frac{\mathbf F^T\cdot\mathbf F-\mathbf I}{2}\cdot\mathbf e_1=E_{11}\,.
\end{align*}
同样$E_{22}$和$E_{33}$分别是$\mathbf e_2$和$\mathbf e_3$方向上的正应变。


\subsection{角度和剪切应变}
首先需要注意小角度近似计算，根据Taylor展开有
\begin{align*}
  \tan\theta &\approx \theta\,,\\
  \sin\theta &\approx \theta \,.
\end{align*}
\begin{figure}[!htbp]
  \centering
  \includegraphics[height=6cm]{fig/2/2.2/2-2-2.png}
  \caption{角度变化和剪切应变}
  \label{fig:2-2:2}
\end{figure}
图\ref{fig:2-2:2}中两个向量夹角余弦为
\begin{align*}
  \cos(\mathbf n_1,\mathbf n_2) =& \mathbf n_1\cdot\mathbf n_2 = \frac{\ud\mathbf x_1}{\|\ud\mathbf x_1\|}\cdot\frac{\ud\mathbf x_2}{\|\ud\mathbf x_2\|}\\
  =& \frac{\mathbf F\cdot\ud\mathbf X_1}{\sqrt{\mathbf F\cdot\ud\mathbf X_1\cdot\mathbf F\cdot\ud\mathbf X_1}}\cdot\frac{\mathbf F\cdot\ud\mathbf X_2}{\sqrt{\mathbf F\cdot\ud\mathbf X_2\cdot\mathbf F\cdot\ud\mathbf X_2}}\\
  =& \frac{\ud\mathbf X_1\cdot\mathbf F^T\cdot\mathbf F\cdot\ud\mathbf X_2}{\sqrt{\ud\mathbf X_1\cdot\mathbf F^T\cdot\mathbf F\cdot\ud\mathbf X_1}\sqrt{\ud\mathbf X_2\cdot\mathbf F^T\cdot\mathbf F\cdot\ud\mathbf X_2}}\\
  =& \frac{\ud\mathbf X_1\cdot(2\mathbf E-\mathbf I)\cdot\ud\mathbf X_2}{\sqrt{\ud\mathbf X_1\cdot(2\mathbf E-\mathbf I)\cdot\ud\mathbf X_1}\sqrt{\ud\mathbf X_2\cdot(2\mathbf E-\mathbf I)\cdot\ud\mathbf X_2}}\\
  =& \frac{\frac{\ud\mathbf X_1}{\|\ud\mathbf X_1\|}\cdot(2\mathbf E-\mathbf I)\cdot\frac{\ud \mathbf X_2}{\|\mathbf X_2\|}}{\sqrt{\frac{\ud\mathbf X_1}{\|\ud\mathbf X_1\|}\cdot(2\mathbf E-\mathbf I)\cdot\frac{\ud\mathbf X_1}{\|\ud\mathbf X_1\|}}\sqrt{\frac{\ud\mathbf X_2}{\|\ud\mathbf X_2\|}\cdot(2\mathbf E-\mathbf I)\cdot\frac{\ud\mathbf X_2}{\|\ud\mathbf X_2\|}}}
\end{align*}
对于$\mathbf N_1=\mathbf e_1$和$\mathbf N_2=\mathbf e_2$得到
\begin{align*}
  \frac{\mathbf e_1\cdot(2\mathbf E-\mathbf I)\cdot\mathbf e_2}{\sqrt{\mathbf e_1\cdot(2\mathbf E-\mathbf I)\cdot\mathbf e_1}\sqrt{\mathbf e_2\cdot(2\mathbf E-\mathbf I)\cdot\mathbf e_2}}=  \frac{2E_{12}}{\sqrt{2E_{11}-1}\sqrt{2E_{22}-1}}\approx2 E_{12}\,.
\end{align*}
如果$\mathbf n_1$和$\mathbf n_2$之间夹角为$\theta$，剪切应变为
\begin{align*}
  \frac{\pi}{2}-\theta\approx\sin(\frac{\pi}{2}-\theta)=\cos(\theta)\approx2E_{12}\,.
\end{align*}

\subsection{应变和位移}
根据\eqref{eq:2-2:2}有
\begin{align*}
  \mathbf E(\mathbf X)=&\frac{1}{2}(\mathbf F^T\cdot\mathbf F-\mathbf I)
  =\frac{1}{2}\left(\left(\frac{\partial \mathbf u}{\partial \mathbf X}+\mathbf I\right)^T\cdot\left(\frac{\partial \mathbf u}{\partial \mathbf X}+\mathbf I\right)-\mathbf I\right)\\
  =&\frac{1}{2}\left(\frac{\partial \mathbf u}{\partial \mathbf X}^T\frac{\partial \mathbf u}{\partial \mathbf X}+\frac{\partial \mathbf u}{\partial \mathbf X}^T+\frac{\partial \mathbf u}{\partial \mathbf X}\right)\\
  \approx&\frac{1}{2}\left(\frac{\partial \mathbf u}{\partial \mathbf X}^T+\frac{\partial \mathbf u}{\partial \mathbf X}\right)\,.
\end{align*}
$\mathbf E(\mathbf X)$是应变的Lagrangian表达形式，$\mathbf\varepsilon(\mathbf x)$是应变的Eulerian表达形式，当$\ud\mathbf x\rightarrow 0$时有
\begin{align*}
  \mathbf E(\mathbf X)\approx\mathbf\varepsilon(\mathbf x)\,.
\end{align*}

\newpage

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%  本构关系
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{本构关系}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%  本构关系
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{线弹性本构关系}
\subsubsection{广义Hooke定律和线弹性}
更多细节见\cite{AsaroLubarda}第161页。定义$\sigma_N$为正应力，$\sigma_S$为切应力，$\varepsilon_N$为正应变，$\varepsilon_S$为切应变，$E$为弹性模量，$G$为剪切模量，胡克定律对正应力和切应力分别为
\begin{subequations}
  \begin{align}\label{eq:2-2:3a}
    \sigma_N =& E \varepsilon_N\,,\\
    \label{eq:2-2:3b}
  \sigma_S =& G \varepsilon_S\,.
  \end{align}
\end{subequations}

$\varepsilon$为轴向应变，$\varepsilon'$为横向应变，泊松比定义为
\begin{align}\label{eq:2-2:4}
  \frac{\varepsilon'}{\varepsilon}=-v\,.
\end{align}
根据Hooke定律得到
\begin{align}\label{eq:2-2:5}
  \varepsilon'=-v\varepsilon=-v \frac{\sigma}{E}\,.
\end{align}
\ref{se:2.1.1}节中定义的应力张量在$\mathbf e_1$、$\mathbf e_2$和$\mathbf e_3$每个方向上有一个正应力，
$\mathbf e_1$方向上的正应力根据Hooke定律在$\mathbf e_1$方向上产生应变，根据Poisson比在$\mathbf e_2$和$\mathbf e_3$方向上也产生应变，其他两个方向的正应力类似。

切应力引起角度变化，$G$是剪切模量，这里注意engineering shear strain和shear strain的区别，\eqref{eq:2-2:6}中是shear strain，\eqref{eq:2-2:3b}是engineering shear strain。这里可以理解Hooke's Law是受力和整体变形的比较，整体变形是engineering shear strain，但实际的应变是shear strain，是engineering shear strain的一半。
\begin{equation}\label{eq:2-2:6}
  \begin{split}
  \varepsilon_{11}=&\frac{\sigma_{11}}{E}-v \frac{\sigma_{22}}{E}-v \frac{\sigma_{33}}{E}\\
  \varepsilon_{22}=&\frac{\sigma_{22}}{E}-v \frac{\sigma_{11}}{E}-v \frac{\sigma_{33}}{E}\\
  \varepsilon_{33}=&\frac{\sigma_{33}}{E}-v \frac{\sigma_{11}}{E}-v \frac{\sigma_{22}}{E}\\
  2\varepsilon_{12}=&\frac{\sigma_{12}}{G}\\
  2\varepsilon_{13}=&\frac{\sigma_{13}}{G}\\
  2\varepsilon_{23}=&\frac{\sigma_{23}}{G}
  \end{split}
\end{equation}

弹性模量、剪切模量和泊松比关系有
\begin{align}\label{eq:2-2:7}
  G=\frac{E}{2(1+v)}\,.
\end{align}
将\eqref{eq:2-2:7}代入\eqref{eq:2-2:6}得到
\begin{align*}
  \left(\begin{array}{c}
    \varepsilon_{11}\\
  \varepsilon_{22}\\
  \varepsilon_{33}\\
  2\varepsilon_{12}\\
  2\varepsilon_{13}\\
  2\varepsilon_{23}
  \end{array}\right)=\frac{1}{E}
  \left(\begin{array}{cccccc}
    1 & -v & -v & 0 & 0 & 0\\
    -v & 1 & -v & 0 & 0 & 0\\
    -v & -v & 1 & 0 & 0 & 0\\
    0 & 0 & 0 & 2(1+v) & 0 & 0 \\
    0 & 0 & 0 & 0 & 2(1+v) & 0 \\
    0 & 0 & 0 & 0 & 0 & 2(1+v) 
    \end{array}\right)\left(\begin{array}{c}
    \sigma_{11}\\
  \sigma_{22}\\
  \sigma_{33}\\
  \sigma_{12}\\
  \sigma_{13}\\
  \sigma_{23}
  \end{array}\right)\,.
\end{align*}
\begin{align*}
  \left(\begin{array}{c}
    \sigma_{11}\\
    \sigma_{22}\\
    \sigma_{33}\\
    \sigma_{12}\\
    \sigma_{13}\\
    \sigma_{23}
  \end{array}\right)=\frac{E}{(1+v)(1-2v)}
  \left(\begin{array}{cccccc}
    1-v & v & v & 0 & 0 & 0\\
    v & 1-v & v & 0 & 0 & 0\\
    v & v & 1-v & 0 & 0 & 0\\
    0 & 0 & 0 & \frac{1-2v}{2} & 0 & 0 \\
    0 & 0 & 0 & 0 & \frac{1-2v}{2} & 0 \\
    0 & 0 & 0 & 0 & 0 & \frac{1-2v}{2} 
  \end{array}\right)
\left(\begin{array}{c}
    \varepsilon_{11}\\
  \varepsilon_{22}\\
  \varepsilon_{33}\\
  2\varepsilon_{12}\\
  2\varepsilon_{13}\\
  2\varepsilon_{23}
  \end{array}\right)
\end{align*}
\begin{align*}
  \mu=\frac{E}{2(1+v)}\qquad\lambda=\frac{Ev}{(1+v)(1-2v)}
\end{align*}
\begin{align*}
  \lambda=&2\mu\frac{v}{1-2v}\\
  \lambda(1-2v)=&2\mu v\\
  v =&\frac{\lambda}{2(\lambda + \mu)}
\end{align*}
\begin{align*}
  \left(\begin{array}{c}
    \sigma_{11}\\
    \sigma_{22}\\
    \sigma_{33}\\
    \sigma_{12}\\
    \sigma_{13}\\
    \sigma_{23}
  \end{array}\right)=
  \left(\begin{array}{cccccc}
    2\mu+\lambda & \lambda & \lambda & 0 & 0 & 0\\
    \lambda & 2\mu+\lambda & \lambda & 0 & 0 & 0\\
    \lambda & \lambda & 2\mu+\lambda & 0 & 0 & 0\\
    0 & 0 & 0 & \mu & 0 & 0 \\
    0 & 0 & 0 & 0 & \mu & 0 \\
    0 & 0 & 0 & 0 & 0 & \mu 
  \end{array}\right)
\left(\begin{array}{c}
    \varepsilon_{11}\\
  \varepsilon_{22}\\
  \varepsilon_{33}\\
  2\varepsilon_{12}\\
  2\varepsilon_{13}\\
  2\varepsilon_{23}
  \end{array}\right)
\end{align*}
\begin{align*}
  \left(\begin{array}{ccc}
    \sigma_{11} & \sigma_{12} & \sigma_{13}\\
    \sigma_{21} & \sigma_{22} & \sigma_{23} \\
    \sigma_{31} & \sigma_{32} & \sigma_{33} 
  \end{array}\right)=
  2\mu\left(\begin{array}{ccc}
    \varepsilon_{11} & \varepsilon_{12} & \varepsilon_{13}\\
    \varepsilon_{21} & \varepsilon_{22} & \varepsilon_{23} \\
    \varepsilon_{31} & \varepsilon_{32} & \varepsilon_{33} 
  \end{array}\right) +
  \lambda\left(\begin{array}{ccc}
    \sum_{i=1}^3\varepsilon_{ii} & 0 & 0\\
    0 &\sum_{i=1}^3\varepsilon_{ii} & 0 \\
    0 & 0 & \sum_{i=1}^3\varepsilon_{ii} 
  \end{array}\right)
\end{align*}
\begin{align}
  \mathbf\sigma = 2\mu\mathbf\varepsilon + \lambda\mathrm{tr}(\mathbf \varepsilon)\mathbf 1 = \mathbf C:\mathbf\varepsilon
\end{align}
\begin{align*}
  \mathbf C_{ijkl}=\lambda\delta_{ij}\delta_{kl} + \mu(\delta_{ik}\delta_{jl}+\delta_{il}\delta_{jk})
\end{align*}
\begin{align*}
  \mathbf C=2\mu\mathbf I + \lambda\mathbf 1\otimes\mathbf 1
\end{align*}
\begin{align*}
  \mathbf I = \left(\begin{array}{lll}
    \left(\begin{array}{lll}
    1 & 0 & 0 \\
    0 & 0 & 0 \\
    0 & 0 & 0 
    \end{array}\right) & \left(\begin{array}{lll}
    0 & \frac{1}{2} & 0 \\
    \frac{1}{2} & 0 & 0 \\
    0 & 0 & 0 
    \end{array}\right) & \left(\begin{array}{lll}
    0 & 0 & \frac{1}{2} \\
    0 & 0 & 0 \\
    \frac{1}{2} & 0 & 0 
    \end{array}\right) \\
     \left(\begin{array}{lll}
    0 & \frac{1}{2} & 0 \\
    \frac{1}{2} & 0 & 0 \\
    0 & 0 & 0 
    \end{array}\right) & \left(\begin{array}{lll}
    0 & 0 & 0 \\
    0 & 1 & 0 \\
    0 & 0 & 0 
    \end{array}\right) & \left(\begin{array}{lll}
    0 & 0 & 0 \\
    0 & 0 & \frac{1}{2} \\
    0 & \frac{1}{2} & 0 
     \end{array}\right) \\
     \left(\begin{array}{lll}
    0 & 0 & \frac{1}{2} \\
    0 & 0 & 0 \\
    \frac{1}{2} & 0 & 0 
    \end{array}\right) & \left(\begin{array}{lll}
    0 & 0 & 0 \\
    0 & 0 & \frac{1}{2} \\
    0 & \frac{1}{2} & 0 
    \end{array}\right) & \left(\begin{array}{lll}
    0 & 0 & 0 \\
    0 & 0 & 0 \\
    0 & 0 & 1 
    \end{array}\right) 
    \end{array}\right)
\end{align*}

\begin{align*}
  \mathbf 1\otimes\mathbf 1 = \left(\begin{array}{lll}
    \left(\begin{array}{lll}
      1 & 0 & 0 \\
      0 & 1 & 0 \\
      0 & 0 & 1 
    \end{array}\right) & \left(\begin{array}{lll}
      0 & 0 & 0 \\
      0 & 0 & 0 \\
      0 & 0 & 0 
    \end{array}\right) & \left(\begin{array}{lll}
      0 & 0 & 0 \\
      0 & 0 & 0 \\
      0 & 0 & 0 
    \end{array}\right) \\
    \left(\begin{array}{lll}
      0 & 0 & 0 \\
      0 & 0 & 0 \\
      0 & 0 & 0 
    \end{array}\right) & \left(\begin{array}{lll}
      1 & 0 & 0 \\
      0 & 1 & 0 \\
      0 & 0 & 1 
    \end{array}\right) & \left(\begin{array}{lll}
      0 & 0 & 0 \\
      0 & 0 & 0 \\
      0 & 0 & 0 
    \end{array}\right) \\
    \left(\begin{array}{lll}
      0 & 0 & 0 \\
      0 & 0 & 0 \\
      0 & 0 & 0 
    \end{array}\right) & \left(\begin{array}{lll}
      0 & 0 & 0 \\
      0 & 0 & 0 \\
      0 & 0 & 0 
    \end{array}\right) & \left(\begin{array}{lll}
      1 & 0 & 0 \\
      0 & 1 & 0 \\
      0 & 0 & 1 
    \end{array}\right) 
  \end{array}\right)
\end{align*}

\subsubsection{热弹性本构关系}
在\cite{AsaroLubarda}第132页等式(6.145)给出了热弹性的本构关系如下
\begin{align}
  \mathbf\sigma = 2\mu\mathbf\varepsilon + \lambda\mathrm{tr}(\mathbf \varepsilon)\mathbf 1 - k_T\alpha_0(T-T_0)\delta_{ij}\,.
\end{align}


\newpage
\subsection{弹塑性本构关系}
塑性问题是制造工艺中广泛研究的重要问题，对弹性力学和塑性力学来说，守恒方程和应变/位移关系是一样的，
但是应力/应变本构关系完全不一样。首先要理解塑性力学的现象，塑性力学现象比弹性力学复杂的多，有多种本构关系，本构关系是塑性力学研究的一个重点。
\cite{AsaroLubarda, BertramGlüge, NetoPerićOwen}等文献对塑性本构关系进行了大量的介绍，基本都是按照hooke's law、yield criteria、flow rule、hardening rule、load/uploadcondition、consistent condition介绍的，更多固体力学和塑性力学介绍参见\cite{Bower,HowellKozyreffOckendon,Hill,Kachanov}，有限元塑性介绍参见\cite{ROWESTURGESSHARTLEYPILLINGER,Reddy}。但是这些介绍存在一个问题，不能简单明了的点出重点，就进入了大量泛泛的介绍，因此不易入手计算，也没有具体介绍如何在有限元方法中使用本构关系，因此以下内容重点是简单介绍直接用于计算。 

\subsubsection{弹塑性现象}
所有文献都会对弹塑性现象进行解释，比较深入的会从微观晶体结构的\textbf{slip system}和\textbf{dislocation}介绍为什么会发生塑性变形，比较简单的会从
uniaxial情况下的拉伸压缩去解释应力/应变关系图。应力/应变关系图有复杂和简单两种，复杂图会将弹塑性过程分成多个不同的阶段，简单图会将复杂图的多个阶段进行简化合并。

图\ref{fig:2-3-2:1}是复杂关系图，其中弹性部分除了线弹性OA，还考虑了非线性AB，塑性除了CDE的应力/应变非线性关系，还考虑了BC的应力不变而应变发生变化，此外还考虑了EF应力减小而应变增大的断裂过程，图\ref{fig:2-3-2:1}中塑性力加载/卸载过程实际上应该是图\ref{fig:2-3-2:2}中的情况，$Z_0$和$Y_1$并不重合。 
\begin{figure}[!htbp]
  \centering
  \includegraphics[height=4cm]{fig/2/2-3-2/2-3-2-1.jpg}
  \caption{复杂uniaxial应力/应变关系图}
  \label{fig:2-3-2:1}
\end{figure}
\begin{figure}[!htbp]
  \centering
  \includegraphics[height=4cm]{fig/2/2-3-2/2-3-2-2.png}
  \caption{uniaxial应力/应变关系图}
  \label{fig:2-3-2:2}
\end{figure}

一般会将图\ref{fig:2-3-2:1}和图\ref{fig:2-3-2:2}进行简化，不考虑图\ref{fig:2-3-2:1}中的AB、BC和EF，不考虑$Z_0$和$Y_1$区别，简化为图\ref{fig:2-3-2:3}。
\begin{figure}[!htbp]
  \centering
  \includegraphics[height=4cm]{fig/2/2-3-2/2-3-2-3.png}
  \caption{uniaxial应力/应变关系图}
  \label{fig:2-3-2:3}
\end{figure}

图\ref{fig:2-3-2:3}还可以继续简化，忽略屈服强度的变化，这是理想塑性问题，如果再忽略线弹性，就是纯塑性问题。
\begin{figure}[!htbp]
  \centering
  \includegraphics[height=4cm]{fig/2/2-3-2/2-3-2-4.png}
  \caption{理想弹塑性}
  \label{fig:2-3-2:4}
\end{figure}
\begin{figure}[!htbp]
  \centering
  \includegraphics[height=4cm]{fig/2/2-3-2/2-3-2-5.png}
  \caption{纯塑性}
  \label{fig:2-3-2:5}
\end{figure}



\subsubsection{一维弹塑性本构}
更多细节见\cite{NetoPerićOwen}第141页6.2节。

\begin{enumerate}
\item[a.] \uline{弹塑性假设}
从图\ref{fig:2-3-2:3}中可以得到一个非常重要的关系式
\begin{align}\label{eq:2-4-2:1}
  \mathbf\sigma = E(\mathbf\varepsilon-\mathbf\varepsilon^p)\,.
\end{align}
\eqref{eq:2-4-2:1}来自一个重要的假设，只要外力卸载马上进入弹性变化。

\item[b.]\uline{屈服准则}
图\ref{fig:2-3-2:3}中弹塑性过程先从线弹性开始，当应力大于$Y_0$的时候，应力/应变不再保持线性关系，当应力达到$Y_1$后进行卸载，卸载过程马上恢复应力/应变线性关系。
当应力恢复为零的时候，应变为$O_1$而不是零，产生塑性变形，再加载应力，这时需要达到$Y_1$才能进入塑性变化。重点需要理解的是$Y_0$和$Y_1$是同一个研究对象的两个不同阶段的屈服力(yield stress)或者屈服极限，这说明屈服力是在变化的，是和受力过程相关的，$Y_1>Y_0$，从$Y_0$到$Y_1$是一个hardening的过程，锻造就是在充分利用hardening的效果，提高被加工工件的屈服极限。

yield criteria非常简单，就是通过一个标量函数yield function ($f$)，根据应力和屈服极限来判断材料是否进入了一个临界状态 ($f=0$)，当材料进入临界状态后，下一步或者应力继续加载进入塑性变化 (保持$f=0$)，或者应力卸载进入线弹性变化 ($f<0$)，进入塑性变化后yield function函数值保持为零是因为屈服极限也在不断变化。\textcolor{red}{这里需要注意屈服极限引入了internal variables，internal variables一般有三个，分别对应塑性应变，isotropic hardening，kinematic hardening。} 这里$\sigma_Y$是一个正常数，因此屈服极限不变，是理想弹塑性问题。 
\begin{align}
  f(\sigma, \alpha) := |\sigma| - \sigma_Y
\end{align}


\item[c.]\uline{流动法则 (flow rule)}
假设$|\sigma|\leq\sigma_Y$，$|\sigma|<\sigma_Y$时，$f<0$为弹性变化，塑性应变$\varepsilon^p=0$，因此$|\sigma|=\sigma_Y$时，$f=0$为塑性变化，塑性应变率为$\gamma\geq 0$，\textcolor{red}{$\varepsilon^p$是第一个内部变量。}
\begin{align}
  \dot{\varepsilon}^p = \gamma\mathrm{sign}(\sigma)
\end{align}


\item[d.]\uline{加载/卸载条件 (loading/unloading condition)}
$\gamma=0$时，$\dot\varepsilon^p=0$为弹性变化，有$f<0$，$\gamma>0$时，$\dot\varepsilon^p\neq0$为塑性变化，有$f=0$。
\begin{align}
  \gamma  f(\sigma) = 0
\end{align}

\item[e.]\uline{一致条件 (consistent condition)}
\begin{align*}
  \dot{\varepsilon}^p = \gamma\mathrm{sign}(\sigma)
\end{align*}
$\gamma=0$时，$\dot{\varepsilon}^p=0$为弹性变化，有$f<0$，$\dot f \neq 0$，
$\gamma>0$时，$\dot{\varepsilon}^p\neq 0$为塑性变化，有$f=0$，$\dot f= 0$。
\begin{align}
  \gamma \dot f(\sigma) = 0
\end{align}


%\end{enumerate}
我们将胡克定律, 屈服准则, 流动法则, 加载/卸载条件, 一致条件合并.



\begin{definition}
  理想弹塑性本构关系为:
  \begin{itemize}
  \item Hooke's law: $\sigma = E(\varepsilon-\varepsilon^p)$
  \item Yield condition: $f(\sigma)=|\sigma|-\sigma_Y\leq 0$
  \item flow rule: $\dot\varepsilon^p = \gamma\mathrm{sign}(\sigma) = \gamma\frac{\partial f}{\partial \sigma}$
  \item harding law : $\sigma_Y=\sigma(\bar\varepsilon^p)$
  \item Kuhn-Tucker complementary conditions: $\gamma\geq 0,\quad f(\sigma)\leq 0,\quad\gamma f(\sigma)=0$
  \item Consistency condition: $\gamma\dot f(\sigma)=0\qquad(\mathrm{if }\quad f(\sigma)=0)$
  \end{itemize}
\end{definition}



%\begin{enumerate}


\item[f.]\uline{等向硬化 (isotropic hardening)}
\begin{align}
  f(\sigma,\alpha)=|\sigma|-(\sigma_Y+K\alpha)\leq 0
\end{align}
$\alpha\geq 0$，$K\geq 0$和$\sigma_Y>0$是常数，如果$K<0$就变成了软化，\textcolor{red}{$\alpha$是第二个内部变量。}
\begin{align}
  \dot \alpha = |\dot \varepsilon^p| = |\gamma\mathrm{sign}(\sigma)| = \gamma 
\end{align}
我们将胡克定律, 屈服准则, 流动法则, 硬化准则, 加载/卸载条件, 一致条件合并.

\begin{definition}
  弹塑性本构关系为:
  \begin{itemize}
  \item Hooke's law: $\sigma = E(\varepsilon-\varepsilon^p)$
  \item Yield condition: $f(\sigma)=|\sigma|-(\sigma_Y + K\alpha)\leq 0$
  \item flow rule and hardening rule: $\dot\varepsilon^p = \gamma\mathrm{sign}(\sigma) = \gamma\frac{\partial f}{\partial \sigma}$, $\dot\alpha = \gamma$
  \item Kuhn-Tucker complementary conditions: $\gamma\geq 0,\quad f(\sigma,\alpha)\leq 0,\quad\gamma f(\sigma,\alpha)=0$
  \item Consistency condition: $\gamma\dot f(\sigma,\alpha)=0\qquad(\mathrm{if }f(\sigma,\alpha)=0)$
  \end{itemize}
\end{definition}
\noindent\textcolor{red}{需要注意的是在理想弹塑性中$f(\sigma)\leq 0$是假设$|\sigma|\leq\sigma_Y$, 而考虑硬化后不需要这个假设, 因为$\sigma_Y+K\alpha$在变化}

将yield criteria中$f$对internal variables的偏导, Hooke's law, flow rule和hardening rule带入consistent condition得到$\gamma$.
\begin{align*}
  \dot f(\sigma,\alpha)=&\frac{\partial f}{\partial \sigma} \dot\sigma + \frac{\partial f}{\partial \alpha} \dot\alpha
  =\mathrm{sign}(\sigma)E(\dot\varepsilon-\dot\varepsilon^p) - K\gamma
  =\mathrm{sign}(\sigma)E\dot\varepsilon - \gamma E - K\gamma = 0 
\end{align*}

\begin{align*}
  \gamma = \frac{\mathrm{sign}(\sigma)E\dot\varepsilon}{E + K} 
\end{align*}

\begin{align*}
  \dot\sigma = E(\dot\varepsilon-\dot\varepsilon^p) 
  = E(\dot\varepsilon-\gamma\mathrm{sign}(\sigma)) 
  = E\left(\dot\varepsilon-\frac{\mathrm{sign}(\sigma)E\dot\varepsilon}{E + K} \mathrm{sign}(\sigma)\right) = \frac{EK}{E + K} \dot\varepsilon 
\end{align*}

\begin{align*}
  \dot\sigma =\left\{
  \begin{array}{ll}
    E\dot\varepsilon &\textrm{if }\gamma = 0 \\
    \frac{EK}{E + K} \dot\varepsilon &\textrm{if }\gamma>0
  \end{array}
  \right.
\end{align*}

\item[g.]\uline{移动硬化 (kinematic hardening)}
通过kinematic hardening和isotropic hardening的比较来理解. isotropic hardening在受力方向变化的时候, 例如''正向加载->卸载->负向加载->卸载''过程中, 正向加载最终产生的屈服力和负向加载初始屈服力大小是一样的. 而对于一些材料, 负向加载初始屈服力比正向加载产生的小, 也就是中心发生的移动. 这个移动也就是kinematic hardening. 
\begin{definition}
  弹塑性本构关系为:
  \begin{itemize}
  \item Hooke's law: $\sigma = E(\varepsilon-\varepsilon^p)$
  \item Yield condition: $f(\sigma,q,\alpha)=|\sigma-q|-(\sigma_Y + K\alpha)\leq 0$
  \item flow rule and hardening rule: $\dot\varepsilon^p = \gamma\mathrm{sign}(\sigma-q)$, $\dot\alpha = \gamma$, $\dot q = \gamma H \mathrm{sign}(\sigma-q)$
  \item Kuhn-Tucker complementary conditions: $\gamma\geq 0,\quad f(\sigma,q,\alpha)\leq 0,\quad\gamma f(\sigma,q,\alpha)=0$
  \item Consistency condition: $\gamma\dot f(\sigma,q,\alpha)=0\qquad(\textrm{if }f(\sigma,q,\alpha)=0)$
  \end{itemize}
\end{definition}

 \begin{align*}
   \dot\sigma =\left\{
   \begin{array}{ll}
     E\dot\varepsilon &\textrm{if }\gamma = 0 \\
     \frac{E(H+K)}{E + (H+K)} \dot\varepsilon &\textrm{if }\gamma>0
   \end{array}
   \right.
 \end{align*}

\end{enumerate}


\textcolor{red}{总而言之，在弹塑性过程中，$\varepsilon^p$、isotropic hardening、kinematic hardening都在变化，需要定义这些内变量对应的方程。}


\subsubsection{多维弹塑性本构}
我们回顾下弹性应力/应变关系.
\begin{align*}
  \mu=\frac{E}{2(1+v)}\qquad\lambda=\frac{Ev}{(1+v)(1-2v)}
\end{align*}
\begin{align*}
  \left(\begin{array}{ccc}
    \sigma_{11} & \sigma_{12} & \sigma_{13}\\
    \sigma_{21} & \sigma_{22} & \sigma_{23} \\
    \sigma_{31} & \sigma_{32} & \sigma_{33} 
  \end{array}\right)=
  2\mu\left(\begin{array}{ccc}
    \varepsilon_{11} & \varepsilon_{12} & \varepsilon_{13}\\
    \varepsilon_{21} & \varepsilon_{22} & \varepsilon_{23} \\
    \varepsilon_{31} & \varepsilon_{32} & \varepsilon_{33} 
  \end{array}\right) +
  \lambda\left(\begin{array}{ccc}
    \sum_{i=1}^3\varepsilon_{ii} & 0 & 0\\
    0 &\sum_{i=1}^3\varepsilon_{ii} & 0 \\
    0 & 0 & \sum_{i=1}^3\varepsilon_{ii} 
  \end{array}\right)
\end{align*}
\begin{align*}
  \mathbf\sigma = 2\mu\mathbf\varepsilon + \lambda\mathrm{tr}(\mathbf \varepsilon)\mathbf I = \mathbf C:\mathbf\varepsilon
\end{align*}
\begin{align*}
  \mathbf C:\mathbf\varepsilon = \mathbf C_{ijkl}\varepsilon_{kl}
\end{align*}
\begin{align*}
  \mathbf C_{ijkl}=\lambda\delta_{ij}\delta_{kl} + \mu(\delta_{ik}\delta_{jl}+\delta_{il}\delta_{jk})
\end{align*}


\begin{definition}
  弹塑性本构关系:
\begin{itemize}
  \item 弹塑性假设: $\mathbf\sigma = \mathbf C:(\mathbf\varepsilon-\mathbf\varepsilon^p)$
  \item 屈服准则: $f (\mathbf \sigma,\mathbf q)$
  \item 流动法则 (flow rule): $\dot{\mathbf\varepsilon}^p=\mathbf\gamma \mathbf r(\mathbf \sigma, \mathbf q)$
  \item 硬化法则 (hardening rule): $\dot{\mathbf q}=-\mathbf\gamma \mathbf h(\mathbf \sigma, \mathbf q)$
  \item 加载/卸载条件 (loading/unloading conditions): $\gamma\geq 0$, $f(\mathbf\sigma,\mathbf q) \leq 0$, $\gamma f(\mathbf\sigma,\mathbf q) = 0$
  \item 一致条件 (consistent conditions): $\gamma\geq 0$, $\gamma \dot f(\mathbf\sigma,\mathbf q) = 0$
\end{itemize}
\end{definition}
根据一致条件得到
\begin{align}
  \gamma = \frac{\partial_{\mathbf\sigma}f:\mathbf C:\dot\varepsilon}{\partial_{\mathbf\sigma}f:\mathbf C:\mathbf r + \partial_{\mathbf q}f\cdot\mathbf h}
\end{align}

\begin{align}
  \dot{\mathbf\sigma}=\mathbf C^{\mathrm{ep}}:\dot{\mathbf\varepsilon}
\end{align}

\begin{align}
  \mathbf C^{\mathrm{ep}} = \left\{\begin{array}{cc}
  \mathbf C & \mathrm{if }\gamma = 0\\
  \mathbf C - \frac{\mathbf C:\mathbf r\bigotimes\mathbf C:\partial_{\mathbf\sigma}f}{\partial_{\sigma}f:\mathbf C:\mathbf r + \partial_{\mathbf q}f\cdot\mathbf h} & \mathrm{if }\gamma > 0
  \end{array}\right.
\end{align}


\newpage
\subsubsection{J2流}
\begin{definition}
  弹塑性本构关系:
\begin{itemize}
  \item 弹塑性假设: $\mathbf\sigma = \mathbf C:(\mathbf\varepsilon-\mathbf\varepsilon^p)$
  \item 屈服准则: $f (\mathbf \sigma,\mathbf q) = \|\eta\|-\sqrt{\frac{2}{3}}K(\alpha)$, $\eta:=\mathrm{dev}(\sigma) - \bar\beta$, $\mathrm{tr}(\bar\beta)=0$
  \item 流动法则 (flow rule): $\dot{\mathbf\varepsilon}^p=\mathbf\gamma\frac{\eta}{\|\eta\|}$
  \item 硬化法则 (hardening rule): $\dot{\bar\beta}=\mathbf\gamma\frac{2}{3}H'(\alpha)\frac{\eta}{\|\eta\|}$, $\dot\alpha=\gamma\sqrt{\frac{2}{3}}$
  \item 加载/卸载条件 (loading/unloading conditions): $\gamma\geq 0$, $f(\mathbf\sigma,\mathbf q) \leq 0$, $\gamma f(\mathbf\sigma,\mathbf q) = 0$
  \item 一致条件 (consistent conditions): $\gamma\geq 0$, $\gamma \dot f(\mathbf\sigma,\mathbf q) = 0$
\end{itemize}
\end{definition}

\begin{align*}
  &\partial_{\sigma}f(\sigma,\alpha,\bar\beta):\dot\sigma + \partial_{\alpha}f(\sigma,\alpha,\bar\beta)\dot\alpha + \partial_{\bar\beta}f(\sigma,\alpha,\bar\beta)\dot{\bar\beta}\\
  =&\partial_{\sigma}f(\sigma,\alpha,\bar\beta):\mathbf C:(\dot{\mathbf\varepsilon}-\dot{\mathbf\varepsilon}^p) + \partial_{\alpha}f(\sigma,\alpha,\bar\beta)\dot\alpha + \partial_{\bar\beta}f(\sigma,\alpha,\bar\beta)\dot{\bar\beta}\\
  =&\partial_{\sigma}f(\sigma,\alpha,\bar\beta):\mathbf C:\left(\dot{\mathbf\varepsilon}-\mathbf\gamma\frac{\eta}{\|\eta\|} \right) + \partial_{\alpha}f(\sigma,\alpha,\bar\beta)\gamma\sqrt{\frac{2}{3}} + \partial_{\bar\beta}f(\sigma,\alpha,\bar\beta):\left(\mathbf\gamma\frac{2}{3}H'(\alpha)\frac{\eta}{\|\eta\|}\right)\\
  =& 0
\end{align*}

\begin{align*}
  \gamma = \frac{\partial_{\sigma}f(\sigma,\alpha,\bar\beta):\mathbf C:\dot{\mathbf\varepsilon}}{\partial_{\sigma}f(\sigma,\alpha,\bar\beta):\mathbf C:\frac{\eta}{\|\eta\|}  - \partial_{\alpha}f(\sigma,\alpha,\bar\beta)\sqrt{\frac{2}{3}} - \partial_{\bar\beta}f(\sigma,\alpha,\bar\beta):\left(\frac{2}{3}H'(\alpha)\frac{\eta}{\|\eta\|}\right)}
\end{align*}

\begin{align*}
  \mathrm{dev}(\sigma)=\left(\begin{array}{lll}
    \sigma_{11}-\frac{1}{3}\sum_{i=1}^3\sigma_{ii} & \sigma_{12} & \sigma_{13} \\
    \sigma_{21} & \sigma_{22}-\frac{1}{3}\sum_{i=1}^3\sigma_{ii} & \sigma_{23} \\
    \sigma_{31} & \sigma_{32} &\sigma_{33}-\frac{1}{3}\sum_{i=1}^3\sigma_{ii} \\
    \end{array}\right)
\end{align*}

\begin{align*}
  \eta:=\mathrm{dev}(\sigma) - \bar\beta = \left(\begin{array}{lll}
    \sigma_{11}-\frac{1}{3}\sum_{i=1}^3\sigma_{ii} - \bar\beta_{11}& \sigma_{12} - \bar\beta_{12}& \sigma_{13} - \bar\beta_{13}\\
    \sigma_{21} - \bar\beta_{21}& \sigma_{22}-\frac{1}{3}\sum_{i=1}^3\sigma_{ii} - \bar\beta_{22}& \sigma_{23} - \bar\beta_{23}\\
    \sigma_{31} - \bar\beta_{31}& \sigma_{32} - \bar\beta_{32}&\sigma_{33}-\frac{1}{3}\sum_{i=1}^3\sigma_{ii} - \bar\beta_{33}\\
    \end{array}\right)
\end{align*}

\begin{align*}
  \partial_{\sigma_{11}}f(\sigma,\alpha,\bar\beta) =& \partial_{\sigma_{11}}\|\eta\|
  = \partial_{\sigma_{11}}\sqrt{\sum_{ij}\eta_{ij}^2}
  = \frac{1}{2}\frac{2\eta_{11}\partial_{\sigma_{11}}\eta_{11}}{\sqrt{\sum_{ij}\eta_{ij}^2}}
  + \frac{1}{2}\frac{2\eta_{22}\partial_{\sigma_{11}}\eta_{22}}{\sqrt{\sum_{ij}\eta_{ij}^2}}
  + \frac{1}{2}\frac{2\eta_{33}\partial_{\sigma_{11}}\eta_{33}}{\sqrt{\sum_{ij}\eta_{ij}^2}}\\
  =& \frac{1}{3}\frac{2\eta_{11}-\eta_{22}-\eta_{33}}{\sqrt{\sum_{ij}\eta_{ij}^2}}\\
  =& \frac{1}{3}\frac{2\sigma_{11}-\sigma_{22}-\sigma_{33}-2\bar\beta_{11}+\bar\beta_{22}+\bar\beta_{33}}{\sqrt{\sum_{ij}\eta_{ij}^2}}\\
  =& \frac{1}{3}\frac{3\sigma_{11}-\sigma_{11}-\sigma_{22}-\sigma_{33}-3\bar\beta_{11}}{\sqrt{\sum_{ij}\eta_{ij}^2}}
\end{align*}

\begin{align*}
  \partial_{\sigma}f(\sigma,\alpha,\bar\beta) =\frac{\eta}{\|\eta\|}
\end{align*}

\begin{align*}
  \mathbf C:\frac{\eta}{\|\eta\|} = \left(2\mu\frac{\eta}{\|\eta\|} 
  + \lambda\mathrm{tr}(\frac{\eta}{\|\eta\|})\mathrm I\right)
  = 2\mu\frac{\eta}{\|\eta\|} 
\end{align*}

\begin{align*}
  \gamma = \frac{\frac{\eta}{\|\eta\|}:\dot{\mathbf\varepsilon}}{1  + \frac{H'+K'}{3\mu}}
\end{align*}


\newpage

\subsubsection{平面J2流}

\begin{definition}弹塑性本构关系:
\begin{enumerate}
  \item 弹塑性假设: $\mathbf\sigma = \mathbf C:(\mathbf\varepsilon-\mathbf\varepsilon^p)$
  \item 屈服准则: $f (\mathbf \sigma,\mathbf q) = \|\eta\|-\sqrt{\frac{2}{3}}K(\alpha)$, $\eta:=\mathrm{dev}(\sigma) - \bar\beta$, $\mathrm{tr}(\bar\beta)=0$
  \item 流动法则 (flow rule): $\dot{\mathbf\varepsilon}^p=\mathbf\gamma\frac{\eta}{\|\eta\|}$
  \item 硬化法则 (hardening rule): $\dot{\bar\beta}=\mathbf\gamma\frac{2}{3}H'(\alpha)\frac{\eta}{\|\eta\|}$, $\dot\alpha=\gamma\sqrt{\frac{2}{3}}$
  \item 加载/卸载条件 (loading/unloading conditions): $\gamma\geq 0$, $f(\mathbf\sigma,\mathbf q) \leq 0$, $\gamma f(\mathbf\sigma,\mathbf q) = 0$
  \item 一致条件 (consistent conditions): $\gamma\geq 0$, $\gamma \dot f(\mathbf\sigma,\mathbf q) = 0$
\end{enumerate}
\end{definition}
从上面的三维本构关系转化二维平面应力本构关系, 注意张量变矢量. 
\begin{definition}弹塑性本构关系:
\begin{enumerate}
  \item 弹塑性假设: $\mathbf\sigma = \mathbf C:(\mathbf\varepsilon-\mathbf\varepsilon^p)$
  \item 屈服准则: $f (\mathbf \sigma,\alpha,\tilde{\beta}) = \sqrt{\eta^T\mathbf P\eta}-\sqrt{\frac{2}{3}}K(\alpha)$, $\eta:=\sigma-\tilde{\beta}$
  \item 流动法则 (flow rule): $\dot{\mathbf\varepsilon}^p=\gamma\mathbf P\eta$
  \item 硬化法则 (hardening rule): $\dot{\tilde\beta}=\mathbf\gamma\frac{2}{3}H'(\alpha)\eta$, $\dot\alpha=\gamma\sqrt{\frac{2}{3}\eta^T\mathbf P\eta}$
  \item 加载/卸载条件 (loading/unloading conditions): $\gamma\geq 0$, $f(\mathbf\sigma,,\alpha,\tilde{\beta}) \leq 0$, $\gamma f(\mathbf\sigma,\alpha,\tilde{\beta}) = 0$
  \item 一致条件 (consistent conditions): $\gamma\geq 0$, $\gamma \dot f(\mathbf\sigma,\alpha,\tilde{\beta}) = 0$
\end{enumerate}
\end{definition}


\begin{align*}
  \sigma=\left(\begin{array}{lll}
    \sigma_{11}  & \sigma_{12} & 0 \\
    \sigma_{21} & \sigma_{22} & 0 \\
    0 & 0 & 0 \\
    \end{array}\right)
\end{align*}

\begin{align*}
  \mathrm{dev}(\sigma)=&\left(\begin{array}{lll}
    \sigma_{11}-\frac{1}{3}\sum_{i=1}^2\sigma_{ii} & \sigma_{12} & 0 \\
    \sigma_{21} & \sigma_{22}-\frac{1}{3}\sum_{i=1}^2\sigma_{ii} & 0 \\
    0 & 0 &-\frac{1}{3}\sum_{i=1}^2\sigma_{ii} \\
  \end{array}\right)\\
  =&\left(\begin{array}{lll}
    \frac{2}{3}\sigma_{11}-\frac{1}{3}\sigma_{22} & \sigma_{12} & 0 \\
    \sigma_{21} & \frac{2}{3}\sigma_{22}-\frac{1}{3}\sigma_{11} & 0 \\
    0 & 0 &-\frac{1}{3}\sum_{i=1}^2\sigma_{ii} \\
    \end{array}\right)
\end{align*}

\begin{align*}
  \left(\begin{array}{l}
    \frac{2}{3}\sigma_{11}-\frac{1}{3}\sigma_{22}\\
    \frac{2}{3}\sigma_{22}-\frac{1}{3}\sigma_{11} \\
    \textcolor{red}{2}\sigma_{12} 
    \end{array}\right) = \frac{1}{3}\left(\begin{array}{lll}
    2&-1&0\\
    -1&2&0\\
    0&0&6 
    \end{array}\right)\left(\begin{array}{l}
    \sigma_{11}\\
    \sigma_{22}\\
    \sigma_{12} 
    \end{array}\right)
\end{align*}
这里重新定义$\sigma$和$\mathrm{dev}(\sigma)$为向量.
\begin{align*}
\mathrm{dev}(\sigma) = \left(\begin{array}{l}
    \frac{2}{3}\sigma_{11}-\frac{1}{3}\sigma_{22}\\
    \frac{2}{3}\sigma_{22}-\frac{1}{3}\sigma_{11} \\
    2\sigma_{12} 
    \end{array}\right) = \frac{1}{3}\left(\begin{array}{lll}
    2&-1&0\\
    -1&2&0\\
    0&0&6 
    \end{array}\right)\left(\begin{array}{l}
    \sigma_{11}\\
    \sigma_{22}\\
    \sigma_{12} 
    \end{array}\right) = \mathbf P \sigma
\end{align*}
并定义
\begin{align*}
\bar\beta = \mathbf P \tilde{\beta}\,.
\end{align*}
\begin{align*}
\eta = \mathrm{dev}(\sigma) - \bar\beta = \mathbf P(\sigma-\tilde\beta)
\end{align*}
重新定义$\eta$
\begin{align*}
\eta = \sigma-\tilde\beta\,.
\end{align*}

\begin{align*}
  \frac{1}{3}\left(\begin{array}{lll}
    2\sigma_{11}-\sigma_{22} -3\bar\beta_{11} & 3\sigma_{12}-3\bar\beta_{12} & 0 \\
    3\sigma_{21} -3\bar\beta_{21}& 2\sigma_{22}-\sigma_{11} -3\bar\beta_{22}& 0 \\
    0 & 0 &-\sum_{i=1}^2\sigma_{ii} + 3\sum_{i=1}^2\bar\beta_{ii}\\
    \end{array}\right)
\end{align*}

\begin{align*}
  &\frac{1}{9}\left(
    (2\sigma_{11}-\sigma_{22} -3\bar\beta_{11})^2 + (3\sigma_{12}-3\bar\beta_{12})^2 +
  (3\sigma_{21} -3\bar\beta_{21})^2 + (2\sigma_{22}-\sigma_{11} -3\bar\beta_{22})^2 + (-\sum_{i=1}^2\sigma_{ii} + 3\sum_{i=1}^2\bar\beta_{ii})^2\right)\\
  =&\frac{1}{9}\left(
  6\sigma_{11}^2 + 6\sigma_{22}^2 + 9\sigma_{12}^2 + 9\sigma_{21}^2 - 6 \sigma_{11}\sigma_{22} + \cdots\right)\\
  =&\frac{1}{3}\left(
    2\sigma_{11}^2 + 2\sigma_{22}^2 + 3\sigma_{12}^2 + 3\sigma_{21}^2 - 2 \sigma_{11}\sigma_{22} + \cdots\right)
\end{align*}


\begin{align*}
  &(\sigma_{11}-\tilde{\beta}_{11},\sigma_{22}-\tilde{\beta}_{22},\sigma_{12}-\tilde{\beta}_{12})
  \left(\begin{array}{l}
    \frac{2}{3}\sigma_{11}-\frac{1}{3}\sigma_{22}-\bar\beta_{11}\\
    \frac{2}{3}\sigma_{22}-\frac{1}{3}\sigma_{11}-\bar\beta_{22} \\
    2\sigma_{12} -\bar\beta_{12}
  \end{array}\right)\\
  =&  
    \frac{2}{3}\sigma_{11}^2-\frac{1}{3}\sigma_{22}\sigma_{11} +
    \frac{2}{3}\sigma_{22}^2-\frac{1}{3}\sigma_{11}\sigma_{22} +
    2\sigma_{12}^2 + \cdots\\
    =&  \frac{1}{3}\left(
    2\sigma_{11}^2-\sigma_{22}\sigma_{11} +
    2\sigma_{22}^2-\sigma_{11}\sigma_{22} +
    6\sigma_{12}^2 + \cdots\right)
\end{align*}

\newpage
  

\subsubsection{热弹塑性本构关系}

\begin{definition}弹塑性本构关系:
\begin{enumerate}
  \item 弹塑性假设: $\mathbf\sigma = \mathbf C:(\mathbf\varepsilon-\mathbf\varepsilon^p)$
  \item 屈服准则: $f (\mathbf \sigma,\mathbf q) = \|\eta\|-\sqrt{\frac{2}{3}}K(\alpha)$, $\eta:=\mathrm{dev}(\sigma) - \bar\beta$, $\mathrm{tr}(\bar\beta)=0$
  \item 流动法则 (flow rule): $\dot{\mathbf\varepsilon}^p=\mathbf\gamma\frac{\eta}{\|\eta\|}$
  \item 硬化法则 (hardening rule): $\dot{\bar\beta}=\mathbf\gamma\frac{2}{3}H'(\alpha)\frac{\eta}{\|\eta\|}$, $\dot\alpha=\gamma\sqrt{\frac{2}{3}}$
  \item 加载/卸载条件 (loading/unloading conditions): $\gamma\geq 0$, $f(\mathbf\sigma,\mathbf q) \leq 0$, $\gamma f(\mathbf\sigma,\mathbf q) = 0$
  \item 一致条件 (consistent conditions): $\gamma\geq 0$, $\gamma \dot f(\mathbf\sigma,\mathbf q) = 0$
\end{enumerate}
\end{definition}

\begin{definition}热弹塑性本构关系:
\begin{enumerate}
  \item 弹塑性假设: $\mathbf\sigma = \mathbf C:(\mathbf\varepsilon-\mathbf\varepsilon^{\mathrm p}-\mathbf\varepsilon^{\mathrm t})$
  \item 屈服准则: $f (\mathbf \tau,\beta,\theta) = \|\mathrm{dev}(\mathbf \tau)\|-\sqrt{\frac{2}{3}}(K(\alpha) + y(\theta))$
  \item 流动法则 (flow rule): $\dot{\mathbf\varepsilon}^p=\mathbf\gamma\frac{\eta}{\|\eta\|}$
  \item 硬化法则 (hardening rule): $\dot{\bar\beta}=\mathbf\gamma\frac{2}{3}H'(\alpha)\frac{\eta}{\|\eta\|}$, $\dot\alpha=\gamma\sqrt{\frac{2}{3}}$
  \item 加载/卸载条件 (loading/unloading conditions): $\gamma\geq 0$, $f(\mathbf\sigma,\mathbf q) \leq 0$, $\gamma f(\mathbf\sigma,\mathbf q) = 0$
  \item 一致条件 (consistent conditions): $\gamma\geq 0$, $\gamma \dot f(\mathbf\sigma,\mathbf q) = 0$
\end{enumerate}
\end{definition}



\newpage


\section{弹性方程}
\subsection{稳态弹性方程}
根据平衡方程、广义Hooke定律和应变位移关系有
\begin{subequations}
  \begin{align}
    \label{eq:2-2:8a}
    &-\nabla\cdot\mathbf \sigma = \mathbf b\,, \\
    \label{eq:2-2:8b}
    &\mathbf \sigma = 2\mu\mathbf \varepsilon + \lambda\mathrm{tr}(\mathbf\varepsilon)\mathbf I\,, \\
    \label{eq:2-2:8c}
    &\mathbf \varepsilon = \frac{1}{2}(\nabla_{\mathbf x}\mathbf u^T+\nabla_{\mathbf x}\mathbf u) \,.
  \end{align}
\end{subequations}
将\eqref{eq:2-2:8b}和\eqref{eq:2-2:8c}代入\eqref{eq:2-2:8a}得到
\begin{align*}
  -\nabla\cdot(2\mu\mathbf \varepsilon + \lambda\mathrm{tr}(\mathbf\varepsilon)\mathbf I) =& \mathbf b
\end{align*}
\begin{align*}
  \mathbf \varepsilon = \frac{1}{2}(\nabla_{\mathbf x}\mathbf u^T+\nabla_{\mathbf x}\mathbf u)
  = \frac{1}{2}\left(\begin{array}{ccc}
    2\frac{\partial u_1}{\partial x_1} &     \frac{\partial u_1}{\partial x_2} + \frac{\partial u_2}{\partial x_1} &     \frac{\partial u_1}{\partial x_3} + \frac{\partial u_3}{\partial x_1}\\
    \frac{\partial u_2}{\partial x_1} + \frac{\partial u_1}{\partial x_2} &     2\frac{\partial u_2}{\partial x_2} &     \frac{\partial u_2}{\partial x_3} + \frac{\partial u_3}{\partial x_2}\\
    \frac{\partial u_3}{\partial x_1} + \frac{\partial u_1}{\partial x_3} &     \frac{\partial u_3}{\partial x_2} + \frac{\partial u_2}{\partial x_3} &    2 \frac{\partial u_3}{\partial x_3}
    \end{array}\right)
\end{align*}
\begin{align*}
  2\mu\mathbf \varepsilon + \lambda\mathrm{tr}(\mathbf\varepsilon)\mathbf I =& \mu\left(\begin{array}{ccc}
    2\frac{\partial u_1}{\partial x_1} &     \frac{\partial u_1}{\partial x_2} + \frac{\partial u_2}{\partial x_1} &     \frac{\partial u_1}{\partial x_3} + \frac{\partial u_3}{\partial x_1}\\
    \frac{\partial u_2}{\partial x_1} + \frac{\partial u_1}{\partial x_2} &     2\frac{\partial u_2}{\partial x_2} &     \frac{\partial u_2}{\partial x_3} + \frac{\partial u_3}{\partial x_2}\\
    \frac{\partial u_3}{\partial x_1} + \frac{\partial u_1}{\partial x_3} &     \frac{\partial u_3}{\partial x_2} + \frac{\partial u_2}{\partial x_3} &    2 \frac{\partial u_3}{\partial x_3}
    \end{array}\right)+\lambda\left(\begin{array}{ccc}
    \sum_{i}^3\frac{\partial u_i}{\partial x_i} & 0 & 0 \\
    0 & \sum_{i}^3\frac{\partial u_i}{\partial x_i}  & 0 \\
    0 & 0 & \sum_{i}^3\frac{\partial u_i}{\partial x_i}
  \end{array}\right)\\
  =&\mu\left(\begin{array}{ccc}
    2\frac{\partial u_1}{\partial x_1} + \frac{\lambda}{\mu}\sum_{i}^3\frac{\partial u_i}{\partial x_i}&     \frac{\partial u_1}{\partial x_2} + \frac{\partial u_2}{\partial x_1} &     \frac{\partial u_1}{\partial x_3} + \frac{\partial u_3}{\partial x_1}\\
    \frac{\partial u_2}{\partial x_1} + \frac{\partial u_1}{\partial x_2} &     2\frac{\partial u_2}{\partial x_2} + \frac{\lambda}{\mu}\sum_{i}^3\frac{\partial u_i}{\partial x_i}&     \frac{\partial u_2}{\partial x_3} + \frac{\partial u_3}{\partial x_2}\\
    \frac{\partial u_3}{\partial x_1} + \frac{\partial u_1}{\partial x_3} &     \frac{\partial u_3}{\partial x_2} + \frac{\partial u_2}{\partial x_3} &    2 \frac{\partial u_3}{\partial x_3} + \frac{\lambda}{\mu}\sum_{i}^3\frac{\partial u_i}{\partial x_i}
    \end{array}\right)
\end{align*}
\begin{gather*}
  -\nabla\cdot(2\mu\mathbf \varepsilon + \lambda\mathrm{tr}(\mathbf\varepsilon)\mathbf I) = \mathbf b\\
  -\left(\begin{array}{c}
    2\mu\frac{\partial^2 u_1}{\partial x_1^2} + \lambda\left(\frac{\partial^2 u_1}{\partial x_1\partial x_1} + \frac{\partial^2 u_2}{\partial x_2\partial x_1} + \frac{\partial^2 u_3}{\partial x_3\partial x_1} \right) + \mu \left(\frac{\partial^2 u_2}{\partial x_1\partial x_2} + \frac{\partial^2 u_1}{\partial x_2\partial x_2}\right)+ \mu \left(\frac{\partial^2 u_3}{\partial x_1\partial x_3} + \frac{\partial^2 u_1}{\partial x_3\partial x_3}\right)\\
    \mu \left(\frac{\partial^2 u_1}{\partial x_2\partial x_1} + \frac{\partial^2 u_2}{\partial x_1\partial x_1}\right)+        2\mu\frac{\partial^2 u_2}{\partial x_2^2} + \lambda\left(\frac{\partial^2 u_1}{\partial x_1\partial x_2} + \frac{\partial^2 u_2}{\partial x_2\partial x_2} + \frac{\partial^2 u_3}{\partial x_3\partial x_2} \right) +  \mu \left(\frac{\partial^2 u_3}{\partial x_2\partial x_3} + \frac{\partial^2 u_2}{\partial x_3\partial x_3}\right)\\
    \mu \left(\frac{\partial^2 u_1}{\partial x_3\partial x_1} + \frac{\partial^2 u_3}{\partial x_1\partial x_1}\right) +  \mu \left(\frac{\partial^2 u_2}{\partial x_3\partial x_2} + \frac{\partial^2 u_3}{\partial x_2\partial x_2}\right) +        2\mu\frac{\partial^2 u_3}{\partial x_3^2} + \lambda\left(\frac{\partial^2 u_1}{\partial x_1\partial x_3} + \frac{\partial^2 u_2}{\partial x_2\partial x_3} + \frac{\partial^2 u_3}{\partial x_3\partial x_3} \right)
  \end{array}\right)=\left(\begin{array}{c}b_1\\b_2\\b_3\end{array}\right)
\end{gather*}
位移方程为
\begin{align}
  -(\mu+\lambda)\nabla(\nabla\cdot\mathbf u) - \mu\nabla^2\mathbf u= \mathbf b \qquad \mathbf x\in\Omega\,.
\end{align}
应力和位移边界条件为
\begin{subequations}
  \begin{align}
    &\mathbf \sigma\cdot\mathbf n = \mathbf g_N &\mathbf x\in\Gamma_N\,,\\
    &\mathbf u = \mathbf g_D &\mathbf x\in\Gamma_N\,.
  \end{align}
\end{subequations}


\subsection{瞬态弹性方程}

\begin{align}
  \rho\dot{\mathbf v} -\nabla\cdot\mathbf \sigma = \rho\hat{\mathbf b} 
\end{align}


\section{热弹性方程}

\begin{subequations}
  \begin{align}
    &\rho\dot{\mathbf v} -\nabla\cdot\mathbf \sigma = \rho\hat{\mathbf b} \\
    &\mathbf\sigma = 2\mu\mathbf\varepsilon + \lambda\mathrm{tr}(\mathbf \varepsilon)\mathbf 1 - k_T\alpha_0(T-T_0)\delta_{ij}\\
    &T_0\frac{E}{(1-2v)}\alpha_0\frac{\ud \mathbf \varepsilon}{\ud t} + c_E\frac{\ud T}{\ud t} + \frac{1}{\rho}\nabla\cdot \left(\mathbf K \nabla T\right) - r  = 0
  \end{align}
\end{subequations}


\subsection{忽略受力振动和温度变形}
忽略受力引起的振动和温度引起的变形，在金属切削问题中受力引起的振动应该是不明显的，温度引起的变形也不明显。
\begin{subequations}
  \begin{align}
    & -\nabla\cdot\mathbf \sigma = \rho\hat{\mathbf b} \\
    &\mathbf\sigma = 2\mu\mathbf\varepsilon + \lambda\mathrm{tr}(\mathbf \varepsilon)\mathbf 1 - k_T\alpha_0(T-T_0)\delta_{ij}\\
    & c_E\frac{\ud T}{\ud t} + \frac{1}{\rho}\nabla\cdot \left(\mathbf K \nabla T\right) - r  = 0
  \end{align}
\end{subequations}


\section{弹塑性方程}

\subsection{一维弹塑性力学方程}
运动方程, 弹塑性本构关系和应变/位移关系得到弹塑性力学方程如下
\begin{subequations}
  \begin{align}
    \label{eq:2-6-1:1a}
    &\rho\dot{v} -\nabla\cdot\sigma = \rho b\,,\\
    \label{eq:2-6-1:1b}
    &\dot\sigma =\left\{
    \begin{array}{ll}
      E\dot\varepsilon &\textrm{if }\gamma = 0 \\
      \frac{E(H+K)}{E + (H+K)} \dot\varepsilon &\textrm{if }\gamma>0
    \end{array}
    \right.\,,\\
    \label{eq:2-6-1:1c}
    &\mathbf \varepsilon = \frac{\partial u}{\partial x} \,.
  \end{align}
\end{subequations}
初始值和边界值条件为
\begin{subequations}
  \begin{align}
    \label{eq:2-6-2:1a}
    &u(x,0) = u_0 & x\in\Omega\,,\\
    \label{eq:2-6-2:1b}
    &v(x,0) =  v_0 & x\in\Omega\,,\\
    \label{eq:2-6-2:1c}
    &\sigma = g_N & x\in\Gamma_N\,,\\
    \label{eq:2-6-2:1d}
    &u = g_D & x\in\Gamma_N\,.
  \end{align}
\end{subequations}
\subsection{多维弹塑性力学方程}





\subsection{弹塑性热力耦合方程}












